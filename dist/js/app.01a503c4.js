(function(t){function e(e){for(var i,r,s=e[0],l=e[1],c=e[2],d=0,p=[];d<s.length;d++)r=s[d],n[r]&&p.push(n[r][0]),n[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(p.length)p.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],i=!0,s=1;s<a.length;s++){var l=a[s];0!==n[l]&&(i=!1)}i&&(o.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},n={app:0},o=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0109":function(t,e,a){"use strict";var i=a("ec8b"),n=a.n(i);n.a},"0586":function(t,e,a){},"0815":function(t,e,a){},"0a64":function(t,e,a){"use strict";var i=a("fd70"),n=a.n(i);n.a},"0e86":function(t,e,a){"use strict";var i=a("0815"),n=a.n(i);n.a},"0eab":function(t,e,a){"use strict";var i=a("6bba"),n=a.n(i);n.a},1:function(t,e){},"1bca":function(t,e,a){"use strict";var i=a("bd3f"),n=a.n(i);n.a},"1ce3":function(t,e,a){"use strict";var i=a("cf97"),n=a.n(i);n.a},"1f95":function(t,e,a){"use strict";var i=a("8cc7"),n=a.n(i);n.a},2:function(t,e){},"20d1":function(t,e,a){"use strict";var i=a("568f"),n=a.n(i);n.a},"20d6":function(t,e,a){"use strict";var i=a("e200"),n=a.n(i);n.a},2571:function(t,e,a){},"2d34":function(t,e,a){},"2eb7":function(t,e,a){},3:function(t,e){},"30cc":function(t,e,a){},"32e4":function(t,e,a){"use strict";var i=a("eb43"),n=a.n(i);n.a},"36a9":function(t,e,a){"use strict";var i=a("8381"),n=a.n(i);n.a},"39dd":function(t,e,a){"use strict";var i=a("0586"),n=a.n(i);n.a},"3fcd":function(t,e,a){"use strict";var i=a("6def"),n=a.n(i);n.a},4:function(t,e){},"438d":function(t,e,a){"use strict";var i=a("cfca"),n=a.n(i);n.a},4660:function(t,e,a){},"46c1":function(t,e,a){},"4a11":function(t,e,a){"use strict";var i=a("fcd1"),n=a.n(i);n.a},"558d":function(t,e,a){"use strict";var i=a("f507"),n=a.n(i);n.a},"568f":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var i=a("2b0e"),n=a("bb71");a("da64");i["a"].use(n["a"],{iconfont:"md"});var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-content",[a("router-view")],1)],1)},r=[],s={name:"App"},l=s,c=a("2877"),u=a("6544"),d=a.n(u),p=a("7496"),v=a("549c"),h=Object(c["a"])(l,o,r,!1,null,null,null),f=h.exports;d()(h,{VApp:p["a"],VContent:v["a"]});var m=a("8c4f"),g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"container"}},[a("app-snackbar"),a("app-toolbar"),a("app-tools"),a("app-studio"),a("div",{attrs:{id:"stepper-item"}},[a("app-stepper")],1),a("div",{attrs:{id:"view-item"}},[a("app-view")],1)],1)},b=[],y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return-1===["loading"].indexOf(t.$route.name)?a("v-navigation-drawer",{attrs:{id:"tools-drawer",fixed:"",clipped:"",value:this.toolsDrawer,"mini-variant":"","mini-variant-width":"60",app:"","mobile-break-point":"800"},on:{input:t.updateToolsDrawerState}},[a("v-list",{staticClass:"pointers-please",attrs:{id:"toolList",dense:""}},[t.getStepTools().includes("pan")?a("app-pan",{attrs:{active:"pan"===t.activeTool},nativeOn:{click:function(e){t.activeTool="pan"}}}):t._e(),a("v-divider"),t.getStepTools().includes("move")?a("app-move",{attrs:{active:"move"===t.activeTool},nativeOn:{click:function(e){t.activeTool="move"}}}):t._e(),t.getStepTools().includes("node")?a("app-node",{attrs:{active:"node"===t.activeTool},nativeOn:{click:function(e){t.activeTool="node"}}}):t._e(),a("v-divider"),t.getStepTools().includes("circle")?a("app-circle",{attrs:{active:"circle"===t.activeTool},nativeOn:{click:function(e){t.activeTool="circle"}}}):t._e(),t.getStepTools().includes("rectangle")?a("app-rectangle",{attrs:{active:"rectangle"===t.activeTool},nativeOn:{click:function(e){t.activeTool="rectangle"}}}):t._e(),t.getStepTools().includes("path")?a("app-path",{attrs:{active:"path"===t.activeTool},nativeOn:{click:function(e){t.activeTool="path"}}}):t._e(),t.getStepTools().includes("pencil")?a("app-pencil",{attrs:{active:"pencil"===t.activeTool},nativeOn:{click:function(e){t.activeTool="pencil"}}}):t._e(),t.getStepTools().includes("polygon")?a("app-polygon",{attrs:{active:"polygon"===t.activeTool},nativeOn:{click:function(e){t.activeTool="polygon"}}}):t._e(),t.getStepTools().includes("paint")?a("app-paint",{attrs:{active:"paint"===t.activeTool},nativeOn:{click:function(e){t.activeTool="paint"}}}):t._e(),t.getStepTools().includes("paste")?a("app-paste",{attrs:{active:"paste"===t.activeTool},nativeOn:{click:function(e){t.activeTool="paste"}}}):t._e(),t.getStepTools().includes("grid")?a("app-grid",{attrs:{active:"grid"===t.activeTool},nativeOn:{click:function(e){t.activeTool="grid"}}}):t._e(),a("v-divider"),t.getStepTools().includes("delete")?a("app-delete",{attrs:{active:"delete"===t.activeTool},nativeOn:{click:function(e){t.activeTool="delete"}}}):t._e(),a("v-divider"),t.getStepTools().includes("faces")?a("app-faces",{attrs:{active:"faces"===t.activeTool},nativeOn:{click:function(e){t.activeTool="faces"}}}):t._e(),t.getStepTools().includes("megas")?a("app-megas",{attrs:{active:"megas"===t.activeTool},nativeOn:{click:function(e){t.activeTool="megas"}}}):t._e(),t.getStepTools().includes("filter")?a("app-filter",{attrs:{active:"filter"===t.activeTool},nativeOn:{click:function(e){t.activeTool="filter"}}}):t._e(),t.getStepTools().includes("edit")?a("app-edit",{attrs:{active:"edit"===t.activeTool},nativeOn:{click:function(e){t.activeTool="edit"}}}):t._e(),t.getStepTools().includes("super-pixel")?a("app-super-pixel",{attrs:{active:"super-pixel"===t.activeTool},nativeOn:{click:function(e){t.activeTool="super-pixel"}}}):t._e(),t.getStepTools().includes("ruler")?a("app-ruler",{attrs:{active:"ruler"===t.activeTool},nativeOn:{click:function(e){t.activeTool="ruler"}}}):t._e()],1)],1):t._e()},w=[],k=a("cebc"),x=a("2f62"),C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"circle",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("i",{class:{fa:!0,"fa-circle":!0,faIcons:!t.active,faIconsActive:t.active}})]),a("span",[t._v(" Circle Tool [c] ")])],1)],1)},O=[],S=(a("6c7b"),a("2222")),I=a.n(S),j={props:{active:{type:Boolean,default:!1}},data:function(){return{toolCircle:null,strokeWidth:2,radius:2e3}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},activeStep:function(t){return t.app.activeStep},strokeScale:function(t){return t.app.strokeScale}})),created:function(){var t=this,e=function(e){t.toolCircle.minDistance=4*t.strokeWidth},a=function(e){t.toolCircle.minDistance=0,t.radius=t.calculateDistance(e.downPoint,e.point);var a=new I.a.Path.Line(e.downPoint,e.point);a.strokeColor=new I.a.Color("#2661D8"),a.strokeColor.alpha=.7,a.strokeWidth=t.strokeWidth,a.add(e.point),a.removeOn({drag:!0,down:!0,up:!0});var i=new I.a.Path.Circle(e.downPoint,t.radius);i.strokeColor=new I.a.Color("#2661D8"),i.strokeColor.alpha=.7,i.strokeWidth=t.strokeWidth,i.removeOn({drag:!0,down:!0,up:!0})},i=function(e){var a=new I.a.Path.Circle(e.downPoint,t.radius);a.strokeColor=new I.a.Color(t.getColor().stroke),a.strokeWidth=t.strokeWidth,a.fillColor=new I.a.Color(t.getColor().fill),a.data.countable=!0,a.data.type="circle",a.data.class="",t.flagAnnotationEdits()};this.toolCircle=new I.a.Tool,this.toolCircle.onMouseDown=e,this.toolCircle.onMouseDrag=a,this.toolCircle.onMouseUp=i},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),Object(x["c"])({getColor:"annotation/getColor"}),{initialiseTool:function(){this.prepareCanvas(),this.toolCircle.activate(),this.radius=this.imageWidth/(100*this.viewportZoom),this.strokeWidth=this.imageWidth*this.strokeScale/(1e3*this.viewportZoom)},calculateDistance:function(t,e){var a=t.x,i=t.y,n=e.x,o=e.y,r=Math.sqrt(Math.pow(n-a,2)+Math.pow(o-i,2));return r}})},T=j,_=(a("ba23"),a("8336")),A=a("ba95"),V=a("3a2f"),P=Object(c["a"])(T,C,O,!1,null,"0312d36f",null),D=P.exports;d()(P,{VBtn:_["a"],VListTile:A["a"],VTooltip:V["a"]});var L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"rectangle",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("v-icon",{class:{"grey--text text--darken-2":!t.active,"blue--text text--darken-1":t.active}},[t._v("\n        crop_landscape\n      ")])],1),a("span",[t._v(" Rectangel Tool [r] ")])],1)],1)},E=[],M={props:{active:{type:Boolean,default:!1}},data:function(){return{toolRect:null,strokeWidth:2}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},strokeScale:function(t){return t.app.strokeScale}})),created:function(){var t=this,e=function(e){var a=new I.a.Path.Rectangle(e.downPoint,e.point);a.strokeColor=new I.a.Color("#2661D8"),a.strokeColor.alpha=.7,a.strokeWidth=t.strokeWidth,a.removeOn({drag:!0,up:!0})},a=function(e){var a=new I.a.Path.Rectangle(e.downPoint,e.point);a.strokeColor=new I.a.Color(t.getColor().stroke),a.fillColor=new I.a.Color(t.getColor().fill),a.strokeWidth=t.strokeWidth,a.data.type="rectangle",a.data.class="",t.flagAnnotationEdits()};this.toolRect=new I.a.Tool,this.toolRect.onMouseDrag=e,this.toolRect.onMouseUp=a},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),Object(x["c"])({getColor:"annotation/getColor"}),{initialiseTool:function(){this.prepareCanvas(),this.toolRect.activate(),this.strokeWidth=this.imageWidth*this.strokeScale/(1e3*this.viewportZoom)}})},W=M,F=(a("f7b0"),a("132d")),B=Object(c["a"])(W,L,E,!1,null,null,null),R=B.exports;d()(B,{VBtn:_["a"],VIcon:F["a"],VListTile:A["a"],VTooltip:V["a"]});var N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"path",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("v-icon",{class:{"grey--text text--darken-2":!t.active,"blue--text text--darken-1":t.active}},[t._v("\n        timeline\n      ")])],1),a("span",[t._v(" Path Tool [p] ")])],1)],1)},Z=[],z={props:{active:{type:Boolean,default:!1}},data:function(){return{toolPen:null,strokeWidth:2,hitOptions:null,path:null}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},strokeScale:function(t){return t.app.strokeScale}})),created:function(){var t=this,e=function(e){t.path&&t.path.data.active||(t.path=t.newPath(),t.path.data.active=!0,t.path.data.class="",t.path.data.type="path");var a=t.path.hitTest(e.point,t.hitOptions);e.modifiers.option?(t.path.closed=!0,t.path.smooth(),t.path.selected=!1,t.path.data.active=!1):a&&a.segment===t.path.firstSegment?(t.path.closed=!0,t.path.fillColor=new I.a.Color(t.getColor().fill),t.path.smooth(),t.path.selected=!1,t.path.data.active=!1):a&&a.segment===t.path.lastSegment?(t.path.selected=!1,t.path.data.active=!1):(t.path.add(e.point),t.path.smooth())},a=function(e){var a=I.a.project.hitTest(e.point,t.hitOptions);a?a.segment===a.item.firstSegment?(t.path.closed=!0,t.path.selected=!1):a.segment!==a.item.firstSegment&&a.segment!==a.item.lastSegment||(t.path.selected=!1):t.path&&t.path.data.active&&(t.path.selected=!0,t.path.closed=!1)},i=function(e){t.flagAnnotationEdits()};this.toolPen=new I.a.Tool,this.toolPen.onMouseDown=e,this.toolPen.onMouseMove=a,this.toolPen.onMouseUp=i},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),Object(x["c"])({getColor:"annotation/getColor"}),{initialiseTool:function(){this.prepareCanvas(),this.toolPen.activate(),this.strokeWidth=this.imageWidth*this.strokeScale/(1e3*this.viewportZoom),this.hitOptions={segments:!0,tolerance:this.strokeWidth}},newPath:function(){var t=new I.a.Path;return t.strokeColor=new I.a.Color(this.getColor().stroke),t.strokeWidth=this.strokeWidth,t.selected=!0,t}})},$=z,G=(a("438d"),Object(c["a"])($,N,Z,!1,null,null,null)),U=G.exports;d()(G,{VBtn:_["a"],VIcon:F["a"],VListTile:A["a"],VTooltip:V["a"]});var H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"pencil",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("i",{class:{fa:!0,"fa-pencil-alt":!0,faIcons:!t.active,faIconsActive:t.active}})]),a("span",[t._v(" Pencil Tool [m] ")])],1)],1)},K=[],q={props:{active:{type:Boolean,default:!1}},data:function(){return{toolPencil:null,strokeWidth:2,hitOptions:null,path:null}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},strokeScale:function(t){return t.app.strokeScale}})),created:function(){var t=this,e=function(e){t.path&&t.path.data.active||(t.path=t.newPath(),t.path.data.active=!0,t.path.data.class="",t.path.data.type="path")},a=function(e){t.path.add(e.point);var a=t.path.hitTest(e.point,t.hitOptions);a&&a.segment===t.path.firstSegment?(t.path.closed=!0,t.path.fillColor=new I.a.Color(t.getColor().fill)):(t.path.closed=!1,t.path.fillColor&&(t.path.fillColor.alpha=0))},i=function(e){var a=t.path.hitTest(e.point,t.hitOptions);a&&a.segment===t.path.firstSegment&&(t.path.closed=!0,t.path.fillColor=new I.a.Color(t.getColor().fill)),t.path.selected=!1,t.path.simplify(),t.path.data.active=!1,t.flagAnnotationEdits()};this.toolPencil=new I.a.Tool,this.toolPencil.onMouseDown=e,this.toolPencil.onMouseDrag=a,this.toolPencil.onMouseUp=i},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),Object(x["c"])({getColor:"annotation/getColor"}),{initialiseTool:function(){this.prepareCanvas(),this.toolPencil.activate(),this.strokeWidth=this.imageWidth*this.strokeScale/(1e3*this.viewportZoom),this.hitOptions={segments:!0,tolerance:this.strokeWidth},this.toolPencil.minDistance=this.strokeWidth},newPath:function(){var t=new I.a.Path;return t.strokeColor=new I.a.Color(this.getColor().stroke),t.strokeWidth=this.strokeWidth,t.selected=!0,t}})},J=q,X=(a("7db0"),Object(c["a"])(J,H,K,!1,null,null,null)),Y=X.exports;d()(X,{VBtn:_["a"],VListTile:A["a"],VTooltip:V["a"]});var Q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"move",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("i",{class:{fa:!0,"fa-mouse-pointer":!0,faIcons:!t.active,faIconsActive:t.active}})]),a("span",[t._v(" Move Tool [v]")])],1)],1)},tt=[],et=(a("759f"),a("7f7f"),a("ac6a"),a("f3e2"),{props:{active:{type:Boolean,default:!1}},data:function(){return{toolMove:null,hitOptions:null,strokeWidth:2,selectionGroup:null,toolMode:"",selectedItemsCache:[]}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},saveState:function(t){return t.annotation.saveState}})),created:function(){var t=this,e=null,a=function(a){e=I.a.project.hitTest(a.point,t.hitOptions),t.selectionGroup.bounds.selected=!1,e?"bounds"===e.type?t.toolMode="transform":a.modifiers.shift&&!e.item.selected?e.item.selected=!0:a.modifiers.shift&&e.item.selected?e.item.selected=!1:e.item.selected?t.toolMode="move":(I.a.project.deselectAll(),t.selectedItemsCache=[],e.item.selected=!0,t.toolMode="moveSingle"):(t.selectedItemsCache.length>0&&t.selectedItemsCache.forEach(function(t){var e=I.a.project.getItem({id:t.id});I.a.project.layers[t.layerIndex].addChild(e)}),t.selectedItemsCache=[],I.a.project.deselectAll(),t.toolMode="select")},i=function(a){if("select"===t.toolMode){var i=new I.a.Shape.Rectangle(a.downPoint,a.point);i.strokeColor="#4D88D4",i.fillColor="#A3C5E8",i.opacity=.3,i.strokeWidth=t.strokeWidth,i.removeOn({drag:!0,down:!0,up:!0}),I.a.project.deselectAll(),I.a.project.getItems({class:"Path",inside:i.bounds,match:t.matchFilter}).forEach(function(t){t.selected=!0})}else if("move"===t.toolMode||"moveSingle"===t.toolMode)t.selectionGroup.children.length>0?t.selectionGroup.position=t.selectionGroup.position.add(a.delta):e.item.position=e.item.position.add(a.delta),t.saveState.changesSaved&&t.flagAnnotationEdits();else if("transform"===t.toolMode){var n=null,o=null,r=null;e&&"top-left"===e.name?(n=a.point.x-t.selectionGroup.bounds.topRight.x,o=a.point.y-t.selectionGroup.bounds.bottomLeft.y,r=t.selectionGroup.bounds.bottomRight):e&&"top-right"===e.name?(n=a.point.x-t.selectionGroup.bounds.topLeft.x,o=a.point.y-t.selectionGroup.bounds.bottomRight.y,r=t.selectionGroup.bounds.bottomLeft):e&&"bottom-right"===e.name?(n=a.point.x-t.selectionGroup.bounds.bottomLeft.x,o=a.point.y-t.selectionGroup.bounds.topRight.y,r=t.selectionGroup.bounds.topLeft):e&&"bottom-left"===e.name&&(n=a.point.x-t.selectionGroup.bounds.bottomRight.x,o=a.point.y-t.selectionGroup.bounds.topLeft.y,r=t.selectionGroup.bounds.topRight);var s=Math.abs(n/t.selectionGroup.bounds.width),l=Math.abs(o/t.selectionGroup.bounds.height);t.selectionGroup.scale(s,l,r),t.saveState.changesSaved&&t.flagAnnotationEdits()}},n=function(e){"move"!==t.toolMode&&"transform"!==t.toolMode&&I.a.project.getItems({class:"Path",selected:!0}).forEach(function(e){t.selectedItemsCache.some(function(t){return t.id===e.id})||t.selectedItemsCache.push({id:e.id,layerIndex:e.layer.index})}),t.selectionGroup=new I.a.Group(I.a.project.selectedItems),t.selectionGroup.isEmpty()||(t.selectionGroup.bounds.selected=!0),t.setSelectedItems(I.a.project.selectedItems)},o=function(e){if(t.selectionGroup&&t.selectionGroup.hitTest(e.point,t.hitOptions)){var a=t.selectionGroup.hitTest(e.point,t.hitOptions);"bottom-right"===a.name||"top-left"===a.name?I.a.view.element.style.cursor="nwse-resize":"bottom-left"===a.name||"top-right"===a.name?I.a.view.element.style.cursor="nesw-resize":"fill"===a.type&&(I.a.view.element.style.cursor="move")}else{var i=document.getElementById("annotation-canvas");i.style.cursor="auto"}},r=function(e){t.active&&("backspace"!==e.key&&"delete"!==e.key||I.a.project.selectedItems&&(t.selectionGroup.bounds.selected=!1,I.a.project.selectedItems.forEach(function(t){"Layer"!==t.className&&t.remove()}),t.flagAnnotationEdits()))};this.toolMove=new I.a.Tool,this.toolMove.onMouseDown=a,this.toolMove.onMouseDrag=i,this.toolMove.onMouseMove=o,this.toolMove.onKeyUp=r,this.toolMove.onMouseUp=n},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",setSelectedItems:"annotation/setSelectedItems",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),{initialiseTool:function(){this.prepareCanvas(),this.toolMove.activate(),this.strokeWidth=this.imageWidth/(500*this.viewportZoom);var t=3*this.strokeWidth;this.hitOptions={segments:!0,stroke:!0,bounds:!0,handles:!0,fill:!0,tolerance:t,match:this.matchFilter},this.selectionGroup=new I.a.Group(I.a.project.selectedItems)},matchFilter:function(t){return(!t.item||"guide"!==t.item.layer.name)&&((!t.layer||"guide"!==t.layer.name)&&!t.locked)}})}),at=et,it=(a("36a9"),Object(c["a"])(at,Q,tt,!1,null,null,null)),nt=it.exports;d()(it,{VBtn:_["a"],VListTile:A["a"],VTooltip:V["a"]});var ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"pan",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[t.active?a("v-icon",{staticClass:"blue--text text--darken-1"},[t._v("\n        lock_open\n      ")]):a("v-icon",{staticClass:"grey--text text--darken-2"},[t._v("\n        lock_outline\n      ")])],1),a("span",[t._v(" Lock View Tool [space] ")])],1)],1)},rt=[],st={props:{active:{type:Boolean,default:!1}},data:function(){return{toolPan:null}},methods:{initialiseTool:function(){document.getElementById("annotation-canvas").setAttribute("class","pointers-no"),document.getElementById("osd-canvas").style.cursor="grab"}}},lt=st,ct=(a("dfca"),Object(c["a"])(lt,ot,rt,!1,null,null,null)),ut=ct.exports;d()(ct,{VBtn:_["a"],VIcon:F["a"],VListTile:A["a"],VTooltip:V["a"]});var dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"node",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("i",{class:{fa:!0,"fa-location-arrow":!0,faIcons:!t.active,faIconsActive:t.active}})]),a("span",[t._v(" Node Tool [a] ")])],1)],1)},pt=[],vt={props:{active:{type:Boolean,default:!1}},data:function(){return{toolNode:null,hitOptions:null}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},saveState:function(t){return t.annotation.saveState}})),created:function(){var t=this,e=null,a=null,i=function(i){e=I.a.project.hitTest(i.point,t.hitOptions),e?e.item.selected?"stroke"===e.type?a="adding-node":"segment"===e.type?(I.a.project.deselectAll(),e.item.selected=!0,e.segment.selected=!0,e.segment.handleIn.selected=!0,e.segment.handleOut.selected=!0,a="adjusting-segment"):"handle-out"!==e.type&&"handle-in"!==e.type||(a="adjusting-handle"):(I.a.project.deselectAll(),e.item.selected=!0,a="selecting"):I.a.project.deselectAll()},n=function(i){e&&("adjusting-segment"===a?e.segment.point=e.segment.point.add(i.delta):"handle-out"===e.type&&"adjusting-handle"===a?e.segment.handleOut=e.segment.handleOut.add(i.delta):"handle-in"===e.type&&"adjusting-handle"===a&&(e.segment.handleIn=e.segment.handleIn.add(i.delta)),t.saveState.changesSaved&&t.flagAnnotationEdits())};this.toolNode=new I.a.Tool,this.toolNode.onMouseDown=i,this.toolNode.onMouseDrag=n},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),{initialiseTool:function(){this.prepareCanvas(),this.toolNode.activate();var t=this.imageWidth/(300*this.viewportZoom);this.hitOptions={segments:!0,stroke:!0,handles:!0,fill:!0,tolerance:t,match:this.matchFilter}},matchFilter:function(t){return(!t.item||"guide"!==t.item.layer.name)&&(!t.layer||"guide"!==t.layer.name)}})},ht=vt,ft=(a("1f95"),Object(c["a"])(ht,dt,pt,!1,null,null,null)),mt=ft.exports;d()(ft,{VBtn:_["a"],VListTile:A["a"],VTooltip:V["a"]});var gt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-delete"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"tool",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("v-icon",{class:{"grey--text text--darken-2":!t.active,"blue--text text--darken-1":t.active}},[t._v("\n        delete\n      ")])],1),a("span",[t._v(" Delete Tool ")])],1)],1)},bt=[],yt={props:{active:{type:Boolean,default:!1}},data:function(){return{toolDelete:null,selectOptions:null,strokeWidth:2}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x}})),created:function(){var t=this,e=null,a=[],i=null,n=function(n){if(e=I.a.project.hitTest(n.point,t.selectOptions),a=!e||"fill"!==e.type&&"stroke"!==e.type&&"segment"!==e.type&&"bounds"!==e.type?[]:[e.item],I.a.project.deselectAll(),i&&(i.selected=!1,i.bounds.selected=!1,i=null),a.length>0){for(var o in a)if(a[o].data.selectWith)for(var r in a[o].data.selectWith)a.push(a[o].data.selectWith[r]);i=new I.a.Group(a),i.selected=!0}},o=function(e){var n=new I.a.Shape.Rectangle(e.downPoint,e.point);if(n.strokeColor="#4D88D4",n.fillColor="#A3C5E8",n.opacity=.3,n.strokeWidth=t.strokeWidth,n.removeOn({drag:!0,down:!0,up:!0}),a=I.a.project.getItems({inside:n.bounds,match:t.matchFilter}),I.a.project.deselectAll(),i&&(i.selected=!1,i.bounds.selected=!1,i=null),a.length>0){for(var o in a)if(a[o].data.selectWith)for(var r in a[o].data.selectWith)a.push(a[o].data.selectWith[r]);i=new I.a.Group(a),i.selected=!0}},r=function(e){i&&i.remove(),t.flagAnnotationEdits()};this.toolDelete=new I.a.Tool,this.toolDelete.onMouseDown=n,this.toolDelete.onMouseDrag=o,this.toolDelete.onMouseUp=r},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),{initialiseTool:function(){this.prepareCanvas(),this.toolDelete.activate(),this.strokeWidth=this.imageWidth/(500*this.viewportZoom);var t=3*this.strokeWidth;this.selectOptions={segments:!0,stroke:!0,bounds:!0,handles:!0,fill:!0,tolerance:t,match:this.matchFilter}},matchFilter:function(t){return(!t.item||"guide"!==t.item.layer.name)&&(!t.layer||"guide"!==t.layer.name)}})},wt=yt,kt=(a("39dd"),Object(c["a"])(wt,gt,bt,!1,null,null,null)),xt=kt.exports;d()(kt,{VBtn:_["a"],VIcon:F["a"],VListTile:A["a"],VTooltip:V["a"]});var Ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"tool",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("i",{class:{fa:!0,"fa-paint-brush":!0,faIcons:!t.active,faIconsActive:t.active}})]),a("span",[t._v(" Paint Tool ")])],1)],1)},Ot=[],St={props:{active:{type:Boolean,default:!1}},data:function(){return{toolPaint:null,strokeWidth:2,radius:2e3,brush:null,overlap:null,path:null,combinedPath:null}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},activeStep:function(t){return t.app.activeStep}})),created:function(){var t=this,e=function(e){t.brush=new I.a.Path.Circle({radius:t.radius,position:e.point,strokeWidth:t.strokeWidth,strokeColor:new I.a.Color({hue:220,saturation:.7,lightness:.5,alpha:1})}),t.brush.removeOn({move:!0,drag:!0})},a=function(e){t.path=new I.a.Path.Circle({radius:t.radius,position:e.point,strokeWidth:t.strokeWidth,strokeColor:t.getColor().stroke,fillColor:t.getColor().fill}).removeOn({drag:!0,up:!0,move:!0});var a=I.a.project.getItem({class:"Path",match:function(t){if("megakaryocyte"!==t.data.class)return!0},overlapping:t.path.bounds});a&&(e.modifiers.alt?t.combinedPath=a.subtract(t.path):t.combinedPath=a.unite(t.path),a.remove())},i=function(e){t.flagAnnotationEdits()};this.toolPaint=new I.a.Tool,this.toolPaint.onMouseMove=e,this.toolPaint.onMouseDrag=a,this.toolPaint.onMouseUp=i},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),Object(x["c"])({getColor:"annotation/getColor"}),{initialiseTool:function(){this.prepareCanvas(),this.toolPaint.activate(),this.radius=this.imageWidth/(100*this.viewportZoom),this.strokeWidth=this.imageWidth/(500*this.viewportZoom)},calculateDistance:function(t,e){var a=t.x,i=t.y,n=e.x,o=e.y,r=Math.sqrt(Math.pow(n-a,2)+Math.pow(o-i,2));return r}})},It=St,jt=(a("3fcd"),Object(c["a"])(It,Ct,Ot,!1,null,"6c3e183c",null)),Tt=jt.exports;d()(jt,{VBtn:_["a"],VListTile:A["a"],VTooltip:V["a"]});var _t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-menu",{attrs:{id:"menu","close-on-content-click":!1,"nudge-width":150,"nudge-right":10,transition:"slide-x-transition","offset-x":""},model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-btn",{attrs:{slot:"activator",id:"tool",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("v-icon",{class:{"grey--text text--darken-2":!t.active,"blue--text text--darken-1":t.active}},[t._v("\n        grid_on\n      ")])],1),a("v-card",[a("v-list",[a("v-list-tile",[a("v-flex",{attrs:{xs5:"","justify-space-around":""}},[a("div",{attrs:{id:"switch"}},[a("v-switch",{attrs:{"input-value":t.visible},on:{change:t.toggleLayerVisibility}})],1)]),a("v-flex",{attrs:{xs6:"","offset-xs1":""}},[t._v("\n            Visibility\n          ")])],1),a("v-list-tile",[a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{value:t.gridWidth,suffix:"px","single-line":""},on:{change:t.setGridWidth},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setGridWidth(e)}}})],1),a("v-flex",{attrs:{xs6:"","offset-xs1":""}},[t._v("\n            Width\n          ")])],1),a("v-list-tile",[a("v-flex",{attrs:{xs5:""}},[a("v-text-field",{attrs:{value:t.gridHeight,suffix:"px","single-line":""},on:{change:t.setGridHeight},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setGridHeight(e)}}})],1),a("v-flex",{attrs:{xs6:"","offset-xs1":""}},[t._v("\n            Height\n          ")])],1)],1)],1)],1)],1)},At=[],Vt=(a("c5f6"),{props:{active:{type:Boolean,default:!1}},data:function(){return{toolGrid:null,strokeWidth:2,gridLayer:!1,gridWidth:0,gridHeight:0,menu:!1,visible:!0}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},imageHeight:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().y},strokeScale:function(t){return t.app.strokeScale}})),created:function(){this.toolGrid=new I.a.Tool},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas"}),{initialiseTool:function(){this.prepareCanvas(),this.strokeWidth=this.imageWidth*this.strokeScale/(1e3*this.viewportZoom),this.gridLayer||this.createGrid(),this.toolGrid.activate()},createGrid:function(){this.gridLayer=new I.a.Layer({name:"guide"}),this.gridWidth=this.imageWidth/10,this.gridHeight=this.imageHeight/10,this.redrawGrid()},redrawGrid:function(){this.gridLayer.activate(),this.gridLayer.removeChildren();for(var t=Math.ceil(this.imageHeight/this.gridHeight),e=Math.ceil(this.imageWidth/this.gridWidth),a=0;a<t;a++)for(var i=0;i<e;i++){var n=new I.a.Path.Rectangle({from:[this.gridWidth*i,this.gridHeight*a],to:[this.gridWidth*i+this.gridWidth,this.gridHeight*a+this.gridHeight],strokeColor:"grey",strokeWidth:this.strokeWidth});n.strokeColor.alpha=.7}},toggleLayerVisibility:function(){this.visible=!this.visible,this.gridLayer.visible=!this.gridLayer.visible},setGridWidth:function(t){var e=this.gridWidth;"string"===typeof t||"number"===typeof t?e=t:t instanceof KeyboardEvent&&(e=t.target.value),this.gridWidth=Number(e),this.redrawGrid()},setGridHeight:function(t){var e=this.gridHeight;"string"===typeof t||"number"===typeof t?e=t:t instanceof KeyboardEvent&&(e=t.target.value),this.gridHeight=Number(e),this.redrawGrid()}})}),Pt=Vt,Dt=(a("20d1"),a("b0af")),Lt=a("0e8f"),Et=a("8860"),Mt=a("e449"),Wt=a("b73d"),Ft=a("2677"),Bt=Object(c["a"])(Pt,_t,At,!1,null,null,null),Rt=Bt.exports;d()(Bt,{VBtn:_["a"],VCard:Dt["a"],VFlex:Lt["a"],VIcon:F["a"],VList:Et["a"],VListTile:A["a"],VMenu:Mt["a"],VSwitch:Wt["a"],VTextField:Ft["a"]});var Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"polygon",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("v-icon",{class:{"grey--text text--darken-2":!t.active,"blue--text text--darken-1":t.active}},[t._v("\n        polymer\n      ")])],1),a("span",[t._v(" Polygon Tool ")])],1)],1)},Zt=[],zt=(a("78ce"),{props:{active:{type:Boolean,default:!1}},data:function(){return{toolPolygon:null,strokeWidth:2,hitOptions:null,path:null,clickTime:null}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},strokeScale:function(t){return t.app.strokeScale}})),created:function(){var t=this,e=function(e){t.path&&t.path.data.active?t.clickTime&&Date.now()-t.clickTime<200?(t.path.fillColor=new I.a.Color(t.getColor().fill),t.path.selected=!1,t.path.data.active=!1):(t.path.add(e.point),t.clickTime=Date.now()):(t.path=t.newPath(),t.path.data.active=!0,t.path.data.class="",t.path.data.type="path",t.path.closed=!0,t.path.add(e.point))},a=function(e){"escape"===e.key&&(t.path.fillColor=new I.a.Color(t.getColor().fill),t.path.selected=!1,t.path.data.active=!1)},i=function(e){t.flagAnnotationEdits()};this.toolPolygon=new I.a.Tool,this.toolPolygon.onMouseDown=e,this.toolPolygon.onKeyDown=a,this.toolPolygon.onMouseUp=i},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),Object(x["c"])({getColor:"annotation/getColor"}),{initialiseTool:function(){this.prepareCanvas(),this.toolPolygon.activate(),this.strokeWidth=this.imageWidth*this.strokeScale/(1e3*this.viewportZoom),this.hitOptions={segments:!0,tolerance:5*this.strokeWidth}},newPath:function(){var t=new I.a.Path;return t.strokeColor=new I.a.Color(this.getColor().stroke),t.strokeWidth=this.strokeWidth,t.selected=!0,t}})}),$t=zt,Gt=(a("8b38"),Object(c["a"])($t,Nt,Zt,!1,null,null,null)),Ut=Gt.exports;d()(Gt,{VBtn:_["a"],VIcon:F["a"],VListTile:A["a"],VTooltip:V["a"]});var Ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"tool",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("v-icon",{class:{"grey--text text--darken-2":!t.active,"blue--text text--darken-1":t.active}},[t._v("\n        format_paint\n      ")])],1),a("span",[t._v(" Paste Tool ")])],1)],1)},Kt=[],qt={props:{active:{type:Boolean,default:!1}},data:function(){return{toolPaste:null,strokeWidth:2,radius:2e3,pasteBrush:null,currentColor:null,currentRaster:null}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},activeStep:function(t){return t.app.activeStep}})),created:function(){var t=this,e=function(e){t.pasteBrush=new I.a.Path.Circle({radius:t.radius,position:e.point,strokeWidth:t.strokeWidth,strokeColor:new I.a.Color({hue:220,saturation:.7,lightness:.5,alpha:1})}),t.pasteBrush.removeOn({move:!0,drag:!0})},a=function(e){var a=I.a.project.hitTest(e.point,{class:I.a.Raster});a&&(t.currentRaster=a.item),e.modifiers.alt&&a&&(t.currentColor=a.color)},i=function(e){if(!e.modifiers.alt){var a=new I.a.Path.Circle({radius:t.radius,position:e.point,fillColor:t.currentColor,locked:!0}).removeOn({drag:!0,up:!0,move:!0}),i=I.a.project.getItem({fillColor:t.currentColor,match:function(t){return t.locked},overlapping:a.bounds});i?(t.combinedPath=i.unite(a),t.combinedPath.locked=!0,i.remove(),a.remove()):a.remove()}},n=function(e){t.flagAnnotationEdits()},o=function(t){"alt"===t.key&&(I.a.view.element.style.cursor="crosshair")},r=function(t){"alt"===t.key&&(I.a.view.element.style.cursor="auto")};this.toolPaste=new I.a.Tool,this.toolPaste.onMouseDown=a,this.toolPaste.onMouseMove=e,this.toolPaste.onMouseDrag=i,this.toolPaste.onKeyDown=o,this.toolPaste.onKeyUp=r,this.toolPaste.onMouseUp=n},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),{initialiseTool:function(){this.prepareCanvas(),this.toolPaste.activate(),this.radius=this.imageWidth/(100*this.viewportZoom),this.strokeWidth=this.imageWidth/(500*this.viewportZoom)}})},Jt=qt,Xt=(a("f5b0"),Object(c["a"])(Jt,Ht,Kt,!1,null,"0c043efb",null)),Yt=Xt.exports;d()(Xt,{VBtn:_["a"],VIcon:F["a"],VListTile:A["a"],VTooltip:V["a"]});var Qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"tool",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("v-icon",{class:{"grey--text text--darken-2":!t.active,"blue--text text--darken-1":t.active}},[t._v("\n        format_paint\n      ")])],1),a("span",[t._v(" Edit Tool ")])],1)],1)},te=[],ee=a("aa78"),ae=a.n(ee),ie={props:{active:{type:Boolean,default:!1}},data:function(){return{toolEdit:null,strokeWidth:2,radius:2e3,editBrush:null,currentColor:"#000000",currentRaster:null}},computed:Object(k["a"])({},Object(x["d"])({OSDviewer:function(t){return t.image.OSDviewer},OSDworld:function(t){return t.image.world},viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},activeStep:function(t){return t.app.activeStep}})),created:function(){var t=this,e=function(e){t.editBrush=new I.a.Path.Circle({radius:t.radius,position:e.point,strokeWidth:t.strokeWidth,strokeColor:new I.a.Color({hue:220,saturation:.7,lightness:.5,alpha:1})}),t.editBrush.removeOn({move:!0,drag:!0})},a=function(e){var a=new I.a.Path.Circle({radius:t.radius,position:e.point,fillColor:t.currentColor,locked:!0,data:{type:"imageEdit"}}),i=I.a.project.getItem({fillColor:t.currentColor,match:function(t){return t.locked},overlapping:a.bounds});i&&(t.combinedPath=i.unite(a),t.combinedPath.locked=!0,i.remove(),a.remove())},i=function(e){t.flagAnnotationEdits()},n=function(e){"alt"===e.key?I.a.view.element.style.cursor="crosshair":"1"===e.key?t.currentColor="#000000":"2"===e.key?t.currentColor="#808080":"3"===e.key&&(t.currentColor="#FFFFFF")},o=function(t){"alt"===t.key&&(I.a.view.element.style.cursor="auto")};this.toolEdit=new I.a.Tool,this.toolEdit.onMouseMove=e,this.toolEdit.onMouseDrag=a,this.toolEdit.onKeyDown=n,this.toolEdit.onKeyUp=o,this.toolEdit.onMouseUp=i},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",editTiles:"backend/editTiles",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),{initialiseTool:function(){this.prepareCanvas(),this.toolEdit.activate(),this.radius=this.imageWidth/(100*this.viewportZoom),this.strokeWidth=this.imageWidth/(500*this.viewportZoom)}})},ne=ie,oe=(a("c9be"),Object(c["a"])(ne,Qt,te,!1,null,"651b3a93",null)),re=oe.exports;d()(oe,{VBtn:_["a"],VIcon:F["a"],VListTile:A["a"],VTooltip:V["a"]});var se=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"polygon",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("v-icon",{class:{"grey--text text--darken-2":!t.active,"blue--text text--darken-1":t.active}},[t._v("\n        straighten\n      ")])],1),a("span",[t._v(" Ruler Tool ")])],1)],1)},le=[],ce={props:{active:{type:Boolean,default:!1}},data:function(){return{toolRuler:null,strokeWidth:2,hitOptions:null,path:null,clickTime:null}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},strokeScale:function(t){return t.app.strokeScale},pixelScaleFactor:function(t){return t.image.pixelScaleFactor.mppX*t.image.pixelScaleFactor.mppY/2}})),created:function(){var t=this,e=function(e){var a=new I.a.Path.Line({from:e.downPoint,to:e.point,strokeColor:"#2661D8",strokeWidth:t.strokeWidth}),i=e.point.subtract(e.downPoint),n=Math.abs(i.angle)>90?1:-1,o=i.rotate(90*n).normalize(),r=e.downPoint.add(i.divide(2)).add(o.multiply(t.strokeWidth)),s=Math.abs(i.angle)>90?180+i.angle:i.angle,l=new I.a.PointText({point:r,content:Math.round(i.length*t.pixelScaleFactor)+"μm",fillColor:"white",justification:"center",fontSize:3*t.strokeWidth}),c=new I.a.Path.Rectangle({from:l.bounds.topLeft,to:l.bounds.bottomRight,fillColor:"#2661D8",strokeWidth:t.strokeWidth,strokeColor:"#2661D8",radius:t.strokeWidth/10}).insertBelow(l);l.rotate(s,r),c.rotate(s,r),a.removeOn({drag:!0,up:!0}),c.removeOn({drag:!0,up:!0}),l.removeOn({drag:!0,up:!0})},a=function(e){var a=new I.a.Path.Line({from:e.downPoint,to:e.point,strokeColor:"#2661D8",strokeWidth:t.strokeWidth,locked:!0,data:{pixelScaleFactor:t.pixelScaleFactor},drawLabel:function(){this.data.label&&(this.data.label.text.remove(),this.data.label.textBackground.remove());var t=this.lastSegment.point.subtract(this.firstSegment.point),e=Math.abs(t.angle)>90?1:-1,a=t.rotate(90*e).normalize(),i=this.firstSegment.point.add(t.divide(2)).add(a.multiply(this.strokeWidth)),n=Math.abs(t.angle)>90?180+t.angle:t.angle,o=new I.a.PointText({point:i,content:Math.round(t.length*this.data.pixelScaleFactor)+"μm",fillColor:"white",justification:"center",fontSize:3*this.strokeWidth,locked:!0}),r=new I.a.Path.Rectangle({from:o.bounds.topLeft,to:o.bounds.bottomRight,fillColor:"#2661D8",strokeWidth:this.strokeWidth,strokeColor:"#2661D8",radius:this.strokeWidth/10,locked:!0}).insertBelow(o);o.rotate(n,i),r.rotate(n,i),this.data.label={text:o,textBackground:r}}});a.drawLabel()};this.toolRuler=new I.a.Tool,this.toolRuler.onMouseDrag=e,this.toolRuler.onMouseUp=a},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),Object(x["c"])({getColor:"annotation/getColor"}),{initialiseTool:function(){this.prepareCanvas(),this.toolRuler.activate(),this.strokeWidth=this.imageWidth*this.strokeScale/(1e3*this.viewportZoom),this.hitOptions={segments:!0,tolerance:5*this.strokeWidth}},newPath:function(){var t=new I.a.Path;return t.strokeColor=new I.a.Color(this.getColor().stroke),t.strokeWidth=this.strokeWidth,t.selected=!0,t}})},ue=ce,de=(a("e03b"),Object(c["a"])(ue,se,le,!1,null,null,null)),pe=de.exports;d()(de,{VBtn:_["a"],VIcon:F["a"],VListTile:A["a"],VTooltip:V["a"]});var ve=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-menu",{attrs:{id:"menu","close-on-content-click":!1,"nudge-width":150,"nudge-right":10,transition:"slide-x-transition","offset-x":""},model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[a("v-btn",{attrs:{slot:"activator",id:"filter",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("i",{class:{fa:!0,"fa-filter":!t.loading,"fa-spinner":t.loading,"fa-pulse":t.loading,faIcons:!t.active,faIconsActive:t.active}})]),a("v-card",[a("v-container",[a("v-layout",[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"Create class filter group",box:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.createFilterGroup(e)}}})],1)],1),a("v-list",t._l(t.listOfFilters,function(e,i){return a("v-list-tile",{key:e.class,attrs:{avatar:""}},[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:t._s(e.class)}})],1),a("v-list-tile-action",[a("v-btn",{attrs:{flat:"",icon:"",color:"pink"},on:{click:function(e){return t.popFilter(i)}}},[a("v-icon",[t._v("close")])],1)],1)],1)}),1)],1)],1)],1)],1)},he=[],fe=(a("d25f"),a("6762"),a("2fdb"),a("6d67"),{props:{active:{type:Boolean,default:!1}},data:function(){return{menu:!1,loading:!1,toggle_multiple:[0,1,2],predictions:{correct:[],flagged:[],incorrect:[],alan:{correct:[],flagged:[],incorrect:[]},gabi:{correct:[],flagged:[],incorrect:[]},gareth:{correct:[],flagged:[],incorrect:[]}},correctPredictions:[],flaggedPredictions:[],incorrectPredictions:[],visiblePredictions:{alan:[0,1,2],gareth:[0,1,2],gabi:[0,1,2]},listOfFilters:[]}},watch:{visiblePrediction:function(t){},listOfFilters:function(t){t.map(function(t){var e=I.a.project.getItems({data:{class:t.class}});e.map(function(t){return t.remove()})})},toggle_multiple:function(t){this.toggle_multiple.includes(0)?(I.a.project.activeLayer.addChildren(this.correctPredictions),this.correctPredictions=[]):(this.correctPredictions=this.predictions.filter(function(t){return"data"in t.data&&"validations"in t.data.data&&"correct"===t.data.data.validations[t.data.data.validations.length-1].decision}),this.correctPredictions.map(function(t){return t.remove()})),this.toggle_multiple.includes(1)?(I.a.project.activeLayer.addChildren(this.flaggedPredictions),this.flaggedPredictions=[]):(this.flaggedPredictions=this.predictions.filter(function(t){return"data"in t.data&&"validations"in t.data.data&&"flag"===t.data.data.validations[t.data.data.validations.length-1].decision}),this.flaggedPredictions.map(function(t){return t.remove()})),this.toggle_multiple.includes(2)?(I.a.project.activeLayer.addChildren(this.incorrectPredictions),this.incorrectPredictions=[]):(this.incorrectPredictions=this.predictions.filter(function(t){return"data"in t.data&&"validations"in t.data.data&&"incorrect"===t.data.data.validations[t.data.data.validations.length-1].decision}),this.incorrectPredictions.map(function(t){return t.remove()}))}},methods:{initialiseTool:function(){var t=I.a.project.getItems({data:{class:"megakaryocyte"}});this.predictions.correct=t.filter(function(t){return"data"in t.data&&"validations"in t.data.data&&"correct"===t.data.data.validations[t.data.data.validations.length-1].decision}),this.predictions.flagged=t.filter(function(t){return"data"in t.data&&"validations"in t.data.data&&"flag"===t.data.data.validations[t.data.data.validations.length-1].decision}),this.predictions.incorrect=t.filter(function(t){return"data"in t.data&&"validations"in t.data.data&&"incorrect"===t.data.data.validations[t.data.data.validations.length-1].decision})},createFilterGroup:function(t){this.listOfFilters.push({class:t.target.value,active:!1})},popFilter:function(t){this.listOfFilters.splice(t,1)}}}),me=fe,ge=(a("0a64"),a("a523")),be=a("a722"),ye=a("40fe"),we=a("5d23"),ke=Object(c["a"])(me,ve,he,!1,null,"50445868",null),xe=ke.exports;d()(ke,{VBtn:_["a"],VCard:Dt["a"],VContainer:ge["a"],VFlex:Lt["a"],VIcon:F["a"],VLayout:be["a"],VList:Et["a"],VListTile:A["a"],VListTileAction:ye["a"],VListTileContent:we["a"],VListTileTitle:we["b"],VMenu:Mt["a"],VTextField:Ft["a"]});var Ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"tool",flat:"",block:""},nativeOn:{click:function(e){return t.activate(e)}},slot:"activator"},[a("i",{class:{fa:!0,"fa-user-tag":!t.loading,"fa-spinner":t.loading,"fa-pulse":t.loading,faIcons:!t.active,faIconsActive:t.active}})]),a("span",[t._v(" Faces Tool ")])],1)],1)},Oe=[],Se=a("62c3"),Ie=a.n(Se),je={props:{active:{type:Boolean,default:!1}},data:function(){return{strokeWidth:400,loading:!1}},computed:Object(k["a"])({},Object(x["d"])({imageUri:function(t){return t.image.images[t.image.activeChannel].source},viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x}})),methods:Object(k["a"])({},Object(x["c"])({getColor:"annotation/getColor"}),{activate:function(){var t=this;this.strokeWidth=this.imageWidth/(500*this.viewportZoom),this.loading=!0,Ie.a.post("https://vision.googleapis.com/v1/images:annotate?key=AIzaSyAeCFXV_oK3QjGQdypK_2hVTH_ck2mshFw",{requests:[{image:{source:{imageUri:this.imageUri}},features:{type:"FACE_DETECTION"},imageContext:{}}]}).then(function(e){t.loading=!1,console.log(e);var a=e.data.responses[0].faceAnnotations;for(var i in a){var n=[];for(var o in a[i].boundingPoly.vertices)n.push(new I.a.Point(a[i].boundingPoly.vertices[o].x,a[i].boundingPoly.vertices[o].y));var r=new I.a.Path(n);r.strokeColor=new I.a.Color(t.getColor()),r.closed=!0,r.strokeWidth=t.strokeWidth,r.data.type="rectangle",r.data.class="face"}}).catch(function(e){t.loading=!1,console.log("could not apply face detection, returned the following error: \n \n"+e)})},drawBoundingFaces:function(t){}})},Te=je,_e=(a("a45a"),Object(c["a"])(Te,Ce,Oe,!1,null,"fd4de720",null)),Ae=_e.exports;d()(_e,{VBtn:_["a"],VListTile:A["a"],VTooltip:V["a"]});var Ve=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"tool",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("v-icon",{class:{"grey--text text--darken-2":!t.active,"blue--text text--darken-1":t.active}},[t._v("\n        youtube_searched_for\n      ")])],1),a("span",[t._v(" Megakaryocyte Classifier ")])],1)],1)},Pe=[],De={props:{active:{type:Boolean,default:!1}},data:function(){return{strokeWidth:400,loading:!1,trackingRect:null}},computed:Object(k["a"])({},Object(x["d"])({imageUri:function(t){return t.image.images[t.image.activeChannel].source},viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},tileSource:function(t){return t.image.OSDviewer.world.getItemAt(0).source},viewport:function(t){return t.image.OSDviewer.viewport},tiledImage:function(t){return t.image.OSDviewer.world.getItemAt(0)}})),created:function(){this.toolMega=new I.a.Tool},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas"}),Object(x["c"])({getColor:"annotation/getColor"}),{initialiseTool:function(){var t=this;this.prepareCanvas(),this.toolMega.activate(),this.strokeWidth=this.imageWidth/(300*this.viewportZoom),Ie.a.get("https://aida-private.firebaseio.com/megas.json ").then(function(e){var a=e.data;console.log(a),a.map(t.drawMega)}).then()},overlapsImage:function(t){return!(t.topLeft.x>this.tiledImage.getBounds().width||t.bottomRight.x<0)&&!(t.topLeft.y>this.tiledImage.getBounds().height||t.bottomRight.y<0)},saveToJSON:function(t,e){var a="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t,null,2)),i=document.createElement("a");i.setAttribute("href",a),i.setAttribute("download",e),document.body.appendChild(i),i.click(),i.remove()},drawMega:function(t){var e=new I.a.Path.Rectangle({from:new I.a.Point(t.x_min,t.y_min),to:new I.a.Point(t.x_max,t.y_max),data:{type:"rectangle",class:t.class,data:{score:t.score,validations:[]}}});e.strokeColor=new I.a.Color(this.getColor().stroke),e.strokeWidth=this.strokeWidth}})},Le=De,Ee=(a("0e86"),Object(c["a"])(Le,Ve,Pe,!1,null,"c8715034",null)),Me=Ee.exports;d()(Ee,{VBtn:_["a"],VIcon:F["a"],VListTile:A["a"],VTooltip:V["a"]});var We=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{id:"tool-tile"}},[a("v-tooltip",{attrs:{id:"tooltip",right:"","open-delay":"700"}},[a("v-btn",{attrs:{slot:"activator",id:"circle",flat:"",block:""},nativeOn:{click:function(e){return t.initialiseTool(e)}},slot:"activator"},[a("v-icon",{class:{"grey--text text--darken-2":!t.active,"blue--text text--darken-1":t.active}},[t._v("\n        blur_on\n      ")])],1),a("span",[t._v(" Super Pixels ")])],1)],1)},Fe=[],Be=(a("96cf"),a("3b8d")),Re=(a("b6e4"),a("63d9"),function(t,e){if(!(t instanceof ImageData))throw new Error("Invalid ImageData");this.imageData=Ye(t.width,t.height),this.imageData.data.set(t.data),e=e||{},this.regionSize=e.regionSize||16,this.minRegionSize=e.minRegionSize||Math.round(.8*this.regionSize),this.maxIterations=e.maxIterations||10,this._compute()});function Ne(t,e,a){for(var i=new Float32Array(3*e*a),n=2.2,o=0;o<e*a;o++){var r=.00392156862*t[4*o+0],s=.00392156862*t[4*o+1],l=.00392156862*t[4*o+2];r=Math.pow(r,n),s=Math.pow(s,n),l=Math.pow(l,n),i[o]=.488718*r+.31068*s+.200602*l,i[o+e*a]=.176204*r+.812985*s+.0108109*l,i[o+2*e*a]=.0102048*s+.989795*l}return i}function Ze(t,e,a){function i(t){return t>.00856?Math.pow(t,.33333333):7.78706891568*t+.1379310336}for(var n=1/3,o=1/3,r=1,s=n/o,l=(1-n-o)/(o*r),c=1/s,u=1/r,d=1/l,p=new Float32Array(3*e*a),v=0;v<e*a;v++){var h=i(t[v]*c),f=i(t[e*a+v]*u),m=i(t[2*e*a+v]*d);p[v]=116*f-16,p[v+e*a]=500*(h-f),p[v+2*e*a]=200*(f-m)}return p}function ze(t,e,a,i){for(var n=0;n<3;n++)for(var o=1;o<i-1;o++)for(var r=1;r<a-1;r++){var s=t[n*a*i+o*a+r-1],l=t[n*a*i+o*a+r+1],c=t[n*a*i+(o+1)*a+r],u=t[n*a*i+(o-1)*a+r];e[o*a+r]+=Math.pow(s-l,2)+Math.pow(c-u,2)}}function $e(t,e,a,i,n,o,r,s,l){for(var c,u,d=0,p=0,v=0;v<o;v++)for(var h=0;h<n;h++){var f=0,m=0,g=1/0,b=void 0,y=void 0;for(c=parseInt(Math.round(r*(h+.5)),10),u=parseInt(Math.round(r*(v+.5)),10),c=Math.max(Math.min(c,s-1),0),u=Math.max(Math.min(u,l-1),0),y=Math.max(0,u-1);y<=Math.min(l-1,u+1);++y)for(b=Math.max(0,c-1);b<=Math.min(s-1,c+1);++b){var w=e[y*s+b];w<g&&(g=w,f=b,m=y)}a[d++]=parseFloat(f),a[d++]=parseFloat(m),a[d++]=t[m*s+f],a[d++]=t[s*l+m*s+f],a[d++]=t[2*s*l+m*s+f],i[p++]=100,i[p++]=r*r}}function Ge(t,e,a,i,n,o,r){for(var s,l=0;l<r;l++)for(var c=0;c<o;c++)s=e[c+l*o],a[s]++,i[5*s+0]+=c,i[5*s+1]+=l,i[5*s+2]+=t[l*o+c],i[5*s+3]+=t[o*r+l*o+c],i[5*s+4]+=t[2*o*r+l*o+c];for(s=0;s<n;s++){var u=1/Math.max(a[s],1e-8);i[5*s]=i[5*s]*u,i[5*s+1]=i[5*s+1]*u,i[5*s+2]=i[5*s+2]*u,i[5*s+3]=i[5*s+3]*u,i[5*s+4]=i[5*s+4]*u}}function Ue(t,e,a,i,n){var o,r,s,l,c,u,d,p,v,h,f,m=new Int32Array(a),g=new Int32Array(a),b=[1,-1,0,0],y=[0,0,1,-1];for(c=0;c<a;++c)if(!m[c]){for(r=t[c],l=0,o=0,g[o++]=c,s=r+1,m[c]=r+1,u=c%i,d=Math.floor(c/i),f=0;f<4;f++)p=u+b[f],v=d+y[f],h=p+v*i,p>=0&&p<i&&v>=0&&v<n&&m[h]&&(s=m[h]);while(l<o){var w=g[l++];for(u=w%i,d=Math.floor(w/i),f=0;f<4;++f)p=u+b[f],v=d+y[f],h=p+v*i,p<=0&&p<i&&v<=0&&v<n&&0===m[h]&&t[h]===r&&(m[h]=r+1,g[o++]=h)}if(o<e)while(o>0)m[g[--o]]=s}for(c=0;c<a;++c)--m[c];for(var k=0;k<a;++k)t[k]=m[k]}function He(t,e,a,i){for(var n=new Float32Array(i.length/2),o=new Float32Array(i.length/2),r=0;r<t.length;r++){var s=t[r];n[s]<e[s]&&(n[s]=e[s],i[2*s+0]=e[s]),o[s]<a[s]&&(o[s]=a[s],i[2*s+1]=a[s])}}function Ke(t,e,a,i,n,o,r,s,l,c,u,d){for(var p,v,h=0;h<n.length;++h)n[h]=1/0;for(var f=c,m=0;m<s*l;++m){var g=Math.round(o[5*m+0]),b=Math.round(o[5*m+1]);for(v=Math.max(0,b-f);v<Math.min(d,b+f);++v)for(p=Math.max(0,g-f);p<Math.min(u,g+f);++p){var y=(p-g)*(p-g)+(v-b)*(v-b),w=t[v*u+p]-o[5*m+2],k=t[u*d+v*u+p]-o[5*m+3],x=t[2*u*d+v*u+p]-o[5*m+4],C=w*w+k*k+x*x,O=Math.sqrt(C/r[2*m+0]+y/r[2*m+1]);O<n[v*u+p]&&(n[v*u+p]=O,e[v*u+p]=m)}}for(v=0;v<d;++v)for(p=0;p<u;++p)r[2*e[v*u+p]]<a[v*u+p]&&(r[2*e[v*u+p]]=a[v*u+p]),r[2*e[v*u+p]+1]<i[v*u+p]&&(r[2*e[v*u+p]+1]=i[v*u+p])}function qe(t,e){for(var a=0,i=0;i<t.length;++i){var n=t[i]-e[i];a+=Math.sqrt(n*n)}return a}function Je(t){for(var e={},a=0,i=0;i<t.length;++i){var n=t[i];void 0===e[n]&&(e[n]=a++),t[i]=e[n]}return a}function Xe(t,e){for(var a=0;a<t.length;++a){var i=Math.floor(t[a]);e[4*a+0]=255&i,e[4*a+1]=i>>>8&255,e[4*a+2]=i>>>16&255,e[4*a+3]=255}}function Ye(t,e){var a=document.createElement("canvas").getContext("2d");return a.createImageData(t,e)}function Qe(t,e,a,i){var n,o=t.width,r=t.height,s=Math.floor(o/e),l=Math.floor(r/e),c=Math.floor(s*l),u=Math.floor(o*r),d=new Float32Array(u),p=new Array(u),v=new Float32Array(5*c),h=new Float32Array(5*c),f=new Float32Array(2*c),m=new Float32Array(u),g=new Float32Array(u),b=new Float32Array(u),y=Ne(t.data,o,r),w=Ze(y,o,r);ze(w,d,o,r),$e(w,d,v,f,s,l,e,o,r);for(var k=new Int32Array(u),x=0;x<i;++x){for(Ke(w,k,m,g,b,v,f,s,l,e,o,r),He(k,m,g,f),n=0;n<p.length;++n)p[n]=0;for(n=0;n<h.length;++n)h[n]=0;Ge(w,k,p,h,c,o,r);var C=qe(v,h);if(C<1e-5)break;for(n=0;n<v.length;++n)v[n]=h[n]}Ue(k,a,u,o,r);var O=Ye(o,r);return O.numSegments=Je(k),Xe(k,O.data),O}Re.prototype.finer=function(){var t=Math.max(5,Math.round(this.regionSize/Math.sqrt(2)));t!==this.regionSize&&(this.regionSize=t,this.minRegionSize=Math.round(.8*t),this._compute())},Re.prototype.coarser=function(){var t=Math.min(640,Math.round(this.regionSize*Math.sqrt(2)));t!==this.regionSize&&(this.regionSize=t,this.minRegionSize=Math.round(.8*t),this._compute())},Re.prototype._compute=function(){this.result=Qe(this.imageData,this.regionSize,this.minRegionSize,this.maxIterations)};var ta={props:{active:{type:Boolean,default:!1}},data:function(){return{toolSuperPixel:null,strokeWidth:2,radius:2e3}},computed:Object(k["a"])({},Object(x["d"])({viewportZoom:function(t){return t.image.OSDviewer.viewport.getZoom(!0)},imageWidth:function(t){return t.image.OSDviewer.world.getItemAt(0).getContentSize().x},activeStep:function(t){return t.app.activeStep},strokeScale:function(t){return t.app.strokeScale},tiledImage:function(t){return t.image.OSDviewer.world.getItemAt(0)},viewer:function(t){return t.image.OSDviewer}})),created:function(){var t=this,e=function(e){var a=t.tiledImage.imageToViewportCoordinates(e.point.x,e.point.y);t.tiledImage.lastDrawn.forEach(function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(e){var i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.bounds.containsPoint(a)&&(i=document.createElement("canvas"),n=i.getContext("2d"),e.drawCanvas(n));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())};this.toolSuperPixel=new I.a.Tool,this.toolSuperPixel.onMouseDown=e},methods:Object(k["a"])({},Object(x["b"])({prepareCanvas:"annotation/prepareCanvas",flagAnnotationEdits:"annotation/flagAnnotationEdits"}),{initialiseTool:function(){this.prepareCanvas(),this.toolSuperPixel.activate(),this.radius=this.imageWidth/(100*this.viewportZoom),this.strokeWidth=this.imageWidth*this.strokeScale/(1e3*this.viewportZoom)}})},ea=ta,aa=(a("558d"),Object(c["a"])(ea,We,Fe,!1,null,"0d40a1b1",null)),ia=aa.exports;d()(aa,{VBtn:_["a"],VIcon:F["a"],VListTile:A["a"],VTooltip:V["a"]});var na={components:{"app-circle":D,"app-rectangle":R,"app-path":U,"app-move":nt,"app-pan":ut,"app-node":mt,"app-pencil":Y,"app-delete":xt,"app-faces":Ae,"app-megas":Me,"app-paint":Tt,"app-grid":Rt,"app-filter":xe,"app-polygon":Ut,"app-paste":Yt,"app-edit":re,"app-super-pixel":ia,"app-ruler":pe},data:function(){return{activeTool:"pan"}},mounted:function(){window.addEventListener("keydown",this.keyDown)},computed:Object(k["a"])({},Object(x["d"])({toolsDrawer:function(t){return t.app.toolsDrawer},activeStep:function(t){return t.app.activeStep},tools:function(t){return t.app.tools}})),methods:Object(k["a"])({},Object(x["c"])({getStepTools:"app/getStepTools"}),Object(x["b"])({setToolsDrawerState:"app/setToolsDrawerState"}),{updateToolsDrawerState:function(t){t||this.setToolsDrawerState(t)},keyDown:function(t){switch(t.keyCode){case 32:document.getElementById("pan").click();break;case 86:document.getElementById("move").click();break;case 65:document.getElementById("node").click();break;case 67:document.getElementById("circle").click();break;case 82:document.getElementById("rectangle").click();break;case 80:document.getElementById("path").click();break;case 77:document.getElementById("pencil").click();break}}})},oa=na,ra=(a("74f9"),a("ce7e6")),sa=a("f774"),la=Object(c["a"])(oa,y,w,!1,null,"2d762e5e",null),ca=la.exports;d()(la,{VDivider:ra["a"],VList:Et["a"],VNavigationDrawer:sa["a"]});var ua=function(){var t=this,e=t.$createElement,a=t._self._c||e;return-1===["loading","landing","examples"].indexOf(t.$route.name)?a("v-navigation-drawer",{attrs:{id:"studio-drawer",fixed:"",clipped:"",value:this.studioDrawer,app:"",right:"","mobile-break-point":"1000"},on:{input:t.updateStudioDrawerState}},[a("div",{staticClass:"pointers-please studioPanel elevation-2"},[a("app-navigator"),a("app-layers"),a("app-images"),a("app-properties")],1)]):t._e()},da=[],pa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"elevation-1"},[a("v-card",{staticClass:"panel"},[a("v-toolbar",{attrs:{id:"toolbar",dense:""}},[a("v-toolbar-title",{staticClass:"toolBarTitle"},[t._v("\n        Navigator\n      ")])],1),a("div",{attrs:{id:"nav-container"}},[a("div",{attrs:{id:"navigator"}})]),a("div",{attrs:{id:"tab-item"}},[a("v-layout",{attrs:{row:"",wrap:"","justify-space-between":""}},[a("v-flex",{attrs:{xs10:""}},[a("v-slider",{staticClass:"pad-slider-right",attrs:{value:t.getZoom,max:t.getMaxZoom,min:"0",step:"0"},on:{input:t.setZoom}})],1),a("v-flex",{attrs:{xs2:""}},[a("v-text-field",{attrs:{value:t.getZoom,suffix:"x","single-line":""},on:{change:t.setZoom},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setZoom(e)}}})],1)],1)],1)],1)],1)},va=[],ha={computed:Object(k["a"])({},Object(x["d"])({viewer:function(t){return t.image.OSDviewer}}),Object(x["c"])("image",["getZoom","getMaxZoom"])),methods:Object(k["a"])({},Object(x["b"])({setZoom:"image/setZoom"}))},fa=ha,ma=(a("9d7a"),a("ba0d")),ga=a("71d9"),ba=a("2a7f"),ya=Object(c["a"])(fa,pa,va,!1,null,"783383ce",null),wa=ya.exports;d()(ya,{VCard:Dt["a"],VFlex:Lt["a"],VLayout:be["a"],VSlider:ma["a"],VTextField:Ft["a"],VToolbar:ga["a"],VToolbarTitle:ba["a"]});var ka=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"elevation-1"},[a("v-card",{staticClass:"panel"},[a("v-toolbar",{attrs:{id:"toolbar",dense:""}},[a("v-toolbar-title",{staticClass:"toolBarTitle"},[t._v("\n        Layers\n      ")]),a("v-spacer"),a("v-btn",{attrs:{icon:""},nativeOn:{click:function(e){return t.newLayer(e)}}},[a("v-icon",{attrs:{id:"iconButton"}},[t._v("\n          add\n        ")])],1)],1),a("v-list",{attrs:{id:"list"}},t._l(t.layers,function(e,i){return a("v-list-group",{key:i,attrs:{"no-action":""}},[a("v-list-tile",{attrs:{slot:"activator","no-action":""},nativeOn:{click:function(e){return t.selectLayer(i)}},slot:"activator"},[a("v-list-tile-content",[a("v-list-tile-title",{class:[t.activeLayer===i?"faIconsActive":"faIcons"]},[t._v("\n              "+t._s(e.name?e.name:"Layer "+i)+"\n            ")])],1)],1),a("div",{attrs:{id:"controls"}},[a("v-tabs",{attrs:{left:"",color:"transparent"}},[a("v-tab",[a("v-icon",[t._v(" opacity ")])],1),a("v-tab",[a("v-icon",[t._v(" text_format ")])],1),a("v-tab",{on:{click:function(e){t.cycleTabEvent=!t.cycleTabEvent}}},[a("v-icon",[t._v(" swap_horiz ")])],1),a("v-tab",[a("v-icon",[t._v(" delete ")])],1),a("v-tabs-items",{attrs:{id:"tab-items"}},[a("v-tab-item",[a("div",{attrs:{id:"tab-item"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs10:""}},[a("v-slider",{staticClass:"pad-slider-right",attrs:{value:100*e.opacity,max:"100","prepend-icon":e.opacity>0?"visibility":"visibility_off"},on:{input:t.setActiveLayerOpacity,"click:prepend":function(a){return t.toggleOpacity(e.opacity)}}})],1),a("v-flex",{attrs:{xs2:""}},[a("v-text-field",{attrs:{value:Math.round(100*e.opacity),suffix:"%","single-line":"",mask:"###"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setActiveLayerOpacity(e)}}})],1)],1)],1)]),a("v-tab-item",[a("div",{attrs:{id:"tab-item"}},[a("v-text-field",{attrs:{value:e.name?e.name:"Layer "+i,"single-line":""},on:{change:t.setActiveLayerName},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setActiveLayerName(e)}}})],1)]),a("v-tab-item",[a("div",{attrs:{id:"tab-item"}},[a("app-cycle",{attrs:{cycleTabEvent:t.cycleTabEvent,layerIndex:i}})],1)]),a("v-tab-item",[a("div",{attrs:{id:"tab-item"}},[a("v-btn",{attrs:{id:"deleteButton",small:"",color:"error",dark:"",flat:"",outline:""},on:{click:function(e){t.deleteActiveLayer().then(function(){t.setActiveLayer(0)})}}},[t._v("\n                    Delete\n                  ")])],1)])],1)],1)],1)],1)}),1)],1)],1)},xa=[],Ca=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{"align-center":"","justify-center":"",row:"","fill-height":""}},[a("v-flex",{attrs:{xs2:""}},[a("v-btn",{attrs:{flat:"",icon:"",color:"primary",disabled:0===this.totalItems},on:{click:function(e){return t.incrementActiveItemBy(-1)}}},[a("v-icon",[t._v(" arrow_back ")])],1)],1),a("v-flex",{attrs:{xs8:""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[this.totalItems>0?a("span",{attrs:{id:"item-title"}},[t._v("\n          "+t._s(this.activeItemIndex+1)+" / "+t._s(this.totalItems)+"\n        ")]):a("span",{attrs:{id:"item-title"}},[t._v("\n          "+t._s(0)+" / "+t._s(this.totalItems)+"\n        ")])])],1),a("v-flex",{attrs:{xs2:""}},[a("v-btn",{attrs:{flat:"",icon:"",color:"primary",disabled:0===this.totalItems},on:{click:function(e){return t.incrementActiveItemBy(1)}}},[a("v-icon",[t._v(" arrow_forward ")])],1)],1)],1)},Oa=[],Sa={props:["cycleTabEvent","layerIndex"],data:function(){return{totalItems:null,activeItemIndex:0}},watch:{cycleTabEvent:function(){this.totalItems=I.a.project.layers[this.layerIndex].getItems({class:"Path"}).length}},computed:Object(k["a"])({},Object(x["d"])({activeLayer:function(t){return t.app.activeLayer},viewport:function(t){return t.image.OSDviewer.viewport}})),methods:{incrementActiveItemBy:function(t){this.activeItemIndex===this.totalItems-1&&t>0?this.activeItemIndex=0:0===this.activeItemIndex&&t<0?this.activeItemIndex=this.totalItems-1:this.activeItemIndex=this.activeItemIndex+t;var e=I.a.project.layers[this.layerIndex].getItems({class:"Path"});this.totalItems=e.length,this.goToItem(e[this.activeItemIndex].bounds)},goToItem:function(t){this.viewport.fitBoundsWithConstraints(this.viewport.imageToViewportRectangle(new ae.a.Rect(t.x,t.y,t.width,t.height)),!0)}}},Ia=Sa,ja=Object(c["a"])(Ia,Ca,Oa,!1,null,null,null),Ta=ja.exports;d()(ja,{VBtn:_["a"],VFlex:Lt["a"],VIcon:F["a"],VLayout:be["a"]});var _a={components:{"app-cycle":Ta},data:function(){return{opacityCache:1,cycleTabEvent:!1}},computed:Object(k["a"])({},Object(x["d"])({layers:function(t){return t.annotation.project.layers},activeLayer:function(t){return t.app.activeLayer},steps:function(t){return t.app.steps},activeStep:function(t){return t.app.activeStep}})),methods:Object(k["a"])({},Object(x["b"])("annotation",["setActiveLayerOpacity","createLayer","exportLayerJSON","setActiveLayer","setActiveLayerName","deleteActiveLayer"]),Object(x["b"])("editor",["setActiveStep"]),{newLayer:function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.createLayer();case 2:this.setActiveLayer(this.layers.length-1);case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),selectLayer:function(t){this.setActiveLayer(t),this.cycleTab=!this.cycleTab},toggleOpacity:function(t){t>0?(this.opacityCache=t,this.setActiveLayerOpacity(0)):this.setActiveLayerOpacity(100*this.opacityCache)}})},Aa=_a,Va=(a("f7f3"),a("56b0")),Pa=a("9910"),Da=a("71a3"),La=a("c671"),Ea=a("fe57"),Ma=a("aac8"),Wa=Object(c["a"])(Aa,ka,xa,!1,null,"768e91e7",null),Fa=Wa.exports;d()(Wa,{VBtn:_["a"],VCard:Dt["a"],VFlex:Lt["a"],VIcon:F["a"],VLayout:be["a"],VList:Et["a"],VListGroup:Va["a"],VListTile:A["a"],VListTileContent:we["a"],VListTileTitle:we["b"],VSlider:ma["a"],VSpacer:Pa["a"],VTab:Da["a"],VTabItem:La["a"],VTabs:Ea["a"],VTabsItems:Ma["a"],VTextField:Ft["a"],VToolbar:ga["a"],VToolbarTitle:ba["a"]});var Ba=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"elevation-1"},[a("v-card",{staticClass:"panel"},[a("v-toolbar",{attrs:{id:"toolbar",dense:""}},[a("v-toolbar-title",{staticClass:"toolBarTitle"},[t._v("\n        Channels\n      ")])],1),a("v-list",{attrs:{id:"list"}},t._l(t.getChannels,function(e,i){return a("v-list-group",{key:i,attrs:{"no-action":""}},[a("v-list-tile",{staticClass:"list-hotfix",attrs:{slot:"activator","no-action":""},nativeOn:{click:function(e){return t.setActiveChannel(i)}},slot:"activator"},[a("v-list-tile-content",[a("v-list-tile-title",{class:[t.activeChannel===i?"faIconsActive":"faIcons"]},[t._v("\n              "+t._s(e.name?e.name:"Channel "+i)+"\n            ")])],1)],1),a("div",{attrs:{id:"controls"}},[a("v-tabs",{attrs:{left:"",color:"transparent"}},[a("v-tab",[a("v-icon",[t._v(" opacity ")])],1),a("v-tab",[a("v-icon",[t._v(" text_format ")])],1),a("v-tab",[a("v-icon",[t._v(" delete ")])],1),a("v-tabs-items",{attrs:{id:"tab-items"}},[a("v-tab-item",{on:{mousedown:function(e){return t.setActiveChannel(i)}}},[a("div",{attrs:{id:"tab-item"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs10:""}},[a("v-slider",{staticClass:"pad-slider-right",attrs:{value:100*e.opacity,max:"100","prepend-icon":e.opacity>0?"visibility":"visibility_off"},on:{input:t.setActiveChannelOpacity,"click:prepend":function(a){return t.toggleOpacity(e.opacity)}}})],1),a("v-flex",{attrs:{xs2:""}},[a("v-text-field",{attrs:{value:Math.round(100*e.opacity),suffix:"%","single-line":"",mask:"###"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setActiveChannelOpacity(e)}}})],1)],1)],1)]),a("v-tab-item",{on:{mousedown:function(e){return t.setActiveChannel(i)}}},[a("div",{attrs:{id:"tab-item"}},[a("v-text-field",{attrs:{value:e.name?e.name:"Channel "+i,"single-line":""},on:{change:t.setActiveChannelName},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setActiveChannelName(e)}}})],1)]),a("v-tab-item",{on:{mousedown:function(e){return t.setActiveChannel(i)}}},[a("div",{attrs:{id:"tab-item"}},[a("v-btn",{attrs:{id:"deleteButton",small:"",color:"error",dark:"",flat:"",outline:""},on:{click:t.deleteChannel}},[t._v("\n                    Delete\n                  ")])],1)])],1)],1)],1)],1)}),1)],1)],1)},Ra=[],Na={data:function(){return{opacityCache:1}},computed:Object(k["a"])({},Object(x["d"])({activeChannel:function(t){return t.image.activeChannel}}),Object(x["c"])({getChannels:"image/getChannels"})),methods:Object(k["a"])({},Object(x["b"])({setActiveChannelOpacity:"image/setActiveChannelOpacity",setActiveChannel:"image/setActiveChannel",setActiveChannelName:"image/setActiveChannelName",deleteChannel:"image/deleteChannel"}),{toggleOpacity:function(t){t>0?(this.opacityCache=t,this.setActiveChannelOpacity(0)):this.setActiveChannelOpacity(100*this.opacityCache)}})},Za=Na,za=(a("ba0b"),Object(c["a"])(Za,Ba,Ra,!1,null,"9b13e958",null)),$a=za.exports;d()(za,{VBtn:_["a"],VCard:Dt["a"],VFlex:Lt["a"],VIcon:F["a"],VLayout:be["a"],VList:Et["a"],VListGroup:Va["a"],VListTile:A["a"],VListTileContent:we["a"],VListTileTitle:we["b"],VSlider:ma["a"],VTab:Da["a"],VTabItem:La["a"],VTabs:Ea["a"],VTabsItems:Ma["a"],VTextField:Ft["a"],VToolbar:ga["a"],VToolbarTitle:ba["a"]});var Ga=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"elevation-1"},[a("v-card",{staticClass:"panel"},[a("v-toolbar",{attrs:{id:"toolbar",dense:""}},[a("v-toolbar-title",{staticClass:"toolBarTitle"},[t._v("\n        Properties\n      ")]),a("v-spacer")],1),a("v-list",{attrs:{id:"list"}},[a("v-list-tile",[a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"faIcons"},[t._v("\n            No. selected items:\n          ")])],1),a("v-list-tile-action",[t._v("\n          "+t._s(t.selectedItems.length)+"\n        ")])],1),a("v-list-tile",[a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"faIcons"},[t._v("\n            Fill colour:\n          ")])],1),a("v-list-tile-action",[a("v-btn",{staticClass:"action pointers-no",attrs:{icon:""}},[a("colour-picker",{staticClass:"pointers-please",attrs:{color:t.selectedFillColor,type:"fill"}})],1)],1)],1),a("v-list-tile",[a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"faIcons"},[t._v("\n            Stroke colour:\n          ")])],1),a("v-list-tile-action",[a("v-btn",{staticClass:"action pointers-no",attrs:{icon:""}},[a("colour-picker",{staticClass:"pointers-please",attrs:{color:t.selectedStrokeColor,type:"stroke"}})],1)],1)],1)],1)],1)],1)},Ua=[],Ha=(a("2caf"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{width:"225px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("a",{attrs:{slot:"activator"},slot:"activator"},[a("div",{staticClass:"color-tile",style:{"background-color":t.color.style}})]),a("v-card",[a("colour-picker",{attrs:{id:"picker"},model:{value:t.colorPick,callback:function(e){t.colorPick=e},expression:"colorPick"}})],1)],1)}),Ka=[],qa=a("c345"),Ja={components:{"colour-picker":qa["Chrome"]},props:{color:{type:Object,default:function(){return{style:"transparent",obj:{h:0,s:0,l:0,a:0}}}},type:{type:String,default:function(){return"fill"}}},data:function(){return{dialog:!1,colorPick:{hsl:this.color.obj}}},computed:Object(k["a"])({},Object(x["d"])({selectedItems:function(t){return t.annotation.selectedItems}})),watch:{dialog:function(t){t?this.colorPick={hsl:this.color.obj}:t||this.selectedItems.length>0&&("fill"===this.type?this.changeItemsFillColor(this.selectedItems):"stroke"===this.type&&this.changeItemsStrokeColor(this.selectedItems))}},methods:{changeItemsFillColor:function(t){var e=this;t.map(function(t){t.fillColor=new I.a.Color({hue:e.colorPick.hsl.h,saturation:e.colorPick.hsl.s,lightness:e.colorPick.hsl.l,alpha:e.colorPick.hsl.a})})},changeItemsStrokeColor:function(t){var e=this;t.map(function(t){t.strokeColor=new I.a.Color({hue:e.colorPick.hsl.h,saturation:e.colorPick.hsl.s,lightness:e.colorPick.hsl.l,alpha:e.colorPick.hsl.a})})}}},Xa=Ja,Ya=(a("882c"),a("169a")),Qa=Object(c["a"])(Xa,Ha,Ka,!1,null,"2af7e386",null),ti=Qa.exports;d()(Qa,{VCard:Dt["a"],VDialog:Ya["a"]});var ei={components:{"colour-picker":ti},computed:Object(k["a"])({},Object(x["d"])({selectedItems:function(t){return t.annotation.selectedItems}}),{selectedFillColor:function(){if(this.selectedItems.length>0&&this.selectedItems.every(function(t,e,a){return null!==t.fillColor&&t.fillColor.hue===a[0].fillColor.hue&&t.fillColor.saturation===a[0].fillColor.saturation&&t.fillColor.lightness===a[0].fillColor.lightness&&t.fillColor.alpha===a[0].fillColor.alpha})){var t={h:this.selectedItems[0].fillColor.hue,s:this.selectedItems[0].fillColor.saturation,l:this.selectedItems[0].fillColor.lightness,a:this.selectedItems[0].fillColor.alpha};return{style:this.selectedItems[0].fillColor.toCSS(),obj:t}}return{style:"transparent",obj:{h:0,s:0,l:0,a:0}}},selectedStrokeColor:function(){if(this.selectedItems.length>0&&this.selectedItems.every(function(t,e,a){return null!==t.strokeColor&&t.strokeColor.hue===a[0].strokeColor.hue&&t.strokeColor.saturation===a[0].strokeColor.saturation&&t.strokeColor.lightness===a[0].strokeColor.lightness&&t.strokeColor.alpha===a[0].strokeColor.alpha})){var t={h:this.selectedItems[0].strokeColor.hue,s:this.selectedItems[0].strokeColor.saturation,l:this.selectedItems[0].strokeColor.lightness,a:this.selectedItems[0].strokeColor.alpha};return{style:this.selectedItems[0].strokeColor.toCSS(),obj:t}}return{style:"transparent",obj:{h:0,s:0,l:0,a:0}}}}),methods:Object(k["a"])({},Object(x["c"])({getSelectedItems:"annotation/getSelectedItems"}))},ai=ei,ii=(a("1ce3"),Object(c["a"])(ai,Ga,Ua,!1,null,"c537d106",null)),ni=ii.exports;d()(ii,{VBtn:_["a"],VCard:Dt["a"],VList:Et["a"],VListTile:A["a"],VListTileAction:ye["a"],VListTileContent:we["a"],VListTileTitle:we["b"],VSpacer:Pa["a"],VToolbar:ga["a"],VToolbarTitle:ba["a"]});var oi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"elevation-1"},[a("v-card",{staticClass:"panel"},[a("v-toolbar",{attrs:{id:"toolbar",dense:""}},[a("v-toolbar-title",{staticClass:"toolBarTitle"},[t._v("\n        Validations\n      ")])],1),a("v-list",{attrs:{id:"list"}},[a("v-list-tile",[a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"faIcons"},[t._v("\n            Prediction:\n          ")])],1),a("v-list-tile-action",[t._v("\n          "+t._s(this.prediction)+"\n        ")])],1),a("v-list-tile",[a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"faIcons"},[t._v("\n            Score:\n          ")])],1),a("v-list-tile-action",[t._v("\n          "+t._s(this.score)+"\n        ")])],1),a("v-list-tile",[a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"faIcons"},[t._v("\n            Weight:\n          ")])],1),a("v-list-tile-action",[t._v("\n          "+t._s(this.weight)+"\n        ")])],1),a("v-list-group",{attrs:{"no-action":""}},[a("v-list-tile",{staticClass:"list-hotfix",attrs:{slot:"activator","no-action":""},slot:"activator"},[a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"faIcons"},[t._v("\n                Validation labels\n              ")])],1)],1),t._l(t.users,function(e,i){return a("v-list-tile",{key:i,attrs:{id:"tab-item"}},[a("v-list-tile-content",[a("v-list-tile-title",{staticClass:"faIcons"},[t._v("\n\n                "+t._s(e)+"\n\n              ")])],1)],1)})],2)],1)],1)],1)},ri=[],si=(a("57e7"),{computed:Object(k["a"])({},Object(x["d"])({selected:function(t){return t.annotation.selectedItems[0]}}),{prediction:function(){return this.selected?this.selected.data.class:""},score:function(){return this.selected?Math.round(100*this.selected.data.data.score)/100:""},weight:function(){return this.selected?Math.round(100*this.selected.data.data.validationWeight)/100:""},validations:function(){return this.selected?this.selected.data.data.validations:""},users:function(){if(this.selected){var t=[];return this.selected.data.data.validations.map(function(e){return t.indexOf(e.user)>-1||t.push(e.user),t}),t}return""},userValidations:function(){if(this.selected){var t={};return this.selected.data.data.validations.map(function(e){t[e.user]=e}),console.log(t),t}return""}}),methods:Object(k["a"])({},Object(x["b"])({}))}),li=si,ci=(a("0109"),Object(c["a"])(li,oi,ri,!1,null,"6625936a",null)),ui=ci.exports;d()(ci,{VCard:Dt["a"],VList:Et["a"],VListGroup:Va["a"],VListTile:A["a"],VListTileAction:ye["a"],VListTileContent:we["a"],VListTileTitle:we["b"],VToolbar:ga["a"],VToolbarTitle:ba["a"]});var di={components:{"app-navigator":wa,"app-layers":Fa,"app-images":$a,"app-properties":ni,"app-validations":ui},computed:Object(k["a"])({},Object(x["d"])({studioDrawer:function(t){return t.app.studioDrawer}})),methods:Object(k["a"])({},Object(x["b"])({setStudioDrawerState:"app/setStudioDrawerState"}),{updateStudioDrawerState:function(t){t||this.setStudioDrawerState(t)}})},pi=di,vi=(a("1bca"),Object(c["a"])(pi,ua,da,!1,null,"600ec4aa",null)),hi=vi.exports;d()(vi,{VNavigationDrawer:sa["a"]});var fi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.steps?a("div",{attrs:{id:"stepper-container"}},[a("v-stepper",{staticClass:"pointers-please",attrs:{id:"stepper",value:t.activeStep+1,"non-linear":""}},[a("v-stepper-header",{attrs:{id:"stepper-header"}},[t._l(t.steps,function(e,i){return[a("v-stepper-step",{key:i,staticClass:"step-icon",attrs:{step:e.id,editable:""},nativeOn:{click:function(a){return t.activateStep(e)}}}),e.id!==t.steps.length?a("v-divider",{key:e.length}):t._e()]})],2)],1),a("div",{staticClass:"elevation-1",attrs:{id:"hint-card"}},["validate"===t.steps[t.activeStep].type?a("app-validate"):a("p",{attrs:{id:"hint"}},[t._v("\n      "+t._s(t.steps[t.activeStep].instruction)+"\n    ")])],1)],1):t._e()},mi=[],gi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"elevation-1",attrs:{id:"hint-card"}},[a("div",{attrs:{id:"hint"}},[t._v("\n    "+t._s(t.steps[t.activeStep].instruction)+"\n\n    "),a("v-divider"),this.validationStarted?a("v-container",{attrs:{fluid:"",id:"validation-controls"}},[a("v-layout",[a("v-flex",{attrs:{xs2:""}},[a("v-btn",{attrs:{flat:"",icon:"",color:"primary"},on:{click:function(e){return t.incrementActiveItemBy(-1)}}},[a("v-icon",[t._v(" arrow_back ")])],1)],1),a("v-flex",{attrs:{xs8:""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("span",{attrs:{id:"item-title"}},[t._v("\n                "+t._s(this.activeItemIndex+1)+" / "+t._s(this.getItemsForValidation().length)+"\n              ")])]),a("v-divider"),a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-btn",{attrs:{small:"",color:"success",outline:!("correct"===this.activeValidationButton),depressed:"correct"===this.activeValidationButton},on:{click:t.markCorrect}},[t._v("\n              Correct\n            ")]),a("v-btn",{attrs:{small:"",color:"warning",outline:!("flag"===this.activeValidationButton),depressed:"flag"===this.activeValidationButton},on:{click:t.flagForReview}},[t._v("\n              Flag for review\n            ")]),a("v-btn",{attrs:{small:"",color:"error",outline:!("incorrect"===this.activeValidationButton),depressed:"incorrect"===this.activeValidationButton},on:{click:t.markIncorrect}},[t._v("\n              Incorrect\n            ")]),a("v-btn",{attrs:{small:"",color:"blue",outline:""},on:{click:function(e){return e.stopPropagation(),t.createNewItem(e)}}},[t._v("\n              Create\n            ")])],1)],1),a("v-flex",{attrs:{xs2:"","text-xs-right":""}},[a("v-btn",{attrs:{flat:"",icon:"",color:"primary"},on:{click:function(e){return t.incrementActiveItemBy(1)}}},[a("v-icon",[t._v(" arrow_forward ")])],1)],1)],1)],1):a("div",[a("v-btn",{staticClass:"primary",attrs:{small:"",disabled:0===this.getItemsForValidation().length},on:{click:t.startValidation}},[t._v(" \n        Start \n      ")])],1)],1)])},bi=[],yi={computed:Object(k["a"])({},Object(x["d"])({activeStep:function(t){return t.app.activeStep},steps:function(t){return t.app.steps},viewport:function(t){return t.image.OSDviewer.viewport},activeValidationIndex:function(t){return t.app.activeValidationIndex},uid:function(t){return t.backend.user.uid},validatorRole:function(t){return t.backend.user.validatorRole}})),data:function(){return{label:"",validationStarted:!1,activeItemIndex:0,activeValidationButton:"",paperItem:null,validationStartTime:0,initialItemData:{},neutralColor:{hue:170,saturation:.44,lightness:.69,alpha:1},highlightColor:{hue:60,saturation:1,lightness:.85,alpha:1}}},mounted:function(){window.addEventListener("keydown",this.keyDown)},destroyed:function(){window.removeEventListener("keydown",this.keyDown)},methods:Object(k["a"])({},Object(x["c"])({getItemsForValidation:"annotation/getItemsForValidation"}),Object(x["b"])({setActiveValidationIndex:"app/setActiveValidationIndex",saveClassValidation:"backend/saveClassValidation",saveBoundingBox:"backend/saveBoundingBox",validateItemsBoundingBox:"backend/validateItemsBoundingBox",createNewItemInDB:"backend/createNewItem"}),{startValidation:function(){0===this.activeValidationIndex?this.activeItemIndex=this.getItemsForValidation().length-1:this.activeItemIndex=this.activeValidationIndex-1,this.incrementActiveItemBy(1),this.validationStarted=!0},incrementActiveItemBy:function(t){this.validationStarted&&(this.checkToSaveValidation(),this.label="",this.paperItem.strokeColor=this.neutralColor),this.activeItemIndex===this.getItemsForValidation().length-1&&t>0?this.activeItemIndex=0:0===this.activeItemIndex&&t<0?this.activeItemIndex=this.getItemsForValidation().length-1:this.activeItemIndex=this.activeItemIndex+t,this.goToItem(this.getItemsForValidation()[this.activeItemIndex]),this.paperItem=this.findPaperItem(this.getItemsForValidation()[this.activeItemIndex]),this.paperItem.strokeColor=this.highlightColor,this.validationStartTime=Date.now(),this.initialItemData={x:this.paperItem.bounds.x,y:this.paperItem.bounds.y,width:this.paperItem.bounds.width,height:this.paperItem.bounds.height}},markCorrect:function(){var t=this;this.label="megakaryocyte",this.paperItem.strokeColor="#4CAF50",this.paperItem.fillColor="#4CAF50",this.flashAndFadeFillColor(this.paperItem),setTimeout(function(){t.incrementActiveItemBy(1),t.setActiveValidationIndex(t.activeItemIndex)},500)},flagForReview:function(){var t=this;this.label="flag",this.paperItem.strokeColor="#FFC107",this.paperItem.fillColor="#FFC107",this.flashAndFadeFillColor(this.paperItem),setTimeout(function(){t.incrementActiveItemBy(1),t.setActiveValidationIndex(t.activeItemIndex)},500)},markIncorrect:function(){var t=this;this.label="negative",this.paperItem.strokeColor="#FF5252",this.paperItem.fillColor="#FF5252",this.flashAndFadeFillColor(this.paperItem),setTimeout(function(){t.incrementActiveItemBy(1),t.setActiveValidationIndex(t.activeItemIndex)},500)},flashAndFadeFillColor:function(t){t.fillColor.alpha=.6;var e=window.setInterval(function(){t.fillColor.alpha=t.fillColor.alpha-.05},100);window.setTimeout(function(){window.clearInterval(e)},800)},createNewItem:function(){var t=I.a.project.getItems({selected:!0,class:I.a.Path})[0];this.createNewItemInDB({timestamp:new Date,boundingBox:{height:t.bounds.height,width:t.bounds.width,x:t.bounds.x,y:t.bounds.y}})},removeItem:function(){console.log("want to remove item");var t=I.a.project.getItems({selected:!0,class:I.a.Path})[0];console.log(t)},goToItem:function(t){this.viewport.fitBoundsWithConstraints(this.viewport.imageToViewportRectangle(new ae.a.Rect(t.x,t.y,t.width,t.height)),!0)},findPaperItem:function(t){return I.a.project.getItem({inside:new I.a.Rectangle(t.x,t.y,t.width,t.height),class:"Path"})},keyDown:function(t){switch(t.keyCode){case 39:this.incrementActiveItemBy(1);break;case 37:this.incrementActiveItemBy(-1);break;case 49:t.getModifierState("Meta")||this.markCorrect();break;case 50:t.getModifierState("Meta")||this.flagForReview();break;case 51:t.getModifierState("Meta")||this.markIncorrect();break;case 52:t.getModifierState("Meta")||this.createNewItem();break}},checkToSaveValidation:function(){var t=this.checkIfLabelAdded();if(t&&this.saveClassValidation({validation:t,docName:this.paperItem.data.name}),"basic"===this.validatorRole){var e=this.checkIfBoundingBoxAdjusted();e?this.saveBoundingBox({boundingBox:e,docName:this.paperItem.data.name,timestamp:new Date,uid:this.uid}):this.validateItemsBoundingBox(this.paperItem.data.name)}},checkIfLabelAdded:function(){return!!this.label&&{uid:this.uid,class:this.label,decisionTimeInMs:Date.now()-this.validationStartTime,timestamp:new Date}},checkIfBoundingBoxAdjusted:function(){var t={x:this.paperItem.bounds.x,y:this.paperItem.bounds.y,width:this.paperItem.bounds.width,height:this.paperItem.bounds.height};return JSON.stringify(t)!==JSON.stringify(this.initialItemData)&&t}})},wi=yi,ki=(a("4a11"),Object(c["a"])(wi,gi,bi,!1,null,"40f86d9f",null)),xi=ki.exports;d()(ki,{VBtn:_["a"],VContainer:ge["a"],VDivider:ra["a"],VFlex:Lt["a"],VIcon:F["a"],VLayout:be["a"]});var Ci={components:{"app-validate":xi},computed:Object(k["a"])({},Object(x["d"])({activeStep:function(t){return t.app.activeStep},steps:function(t){return t.app.steps}})),methods:Object(k["a"])({},Object(x["b"])({setActiveStep:"app/setActiveStep",saveProject:"app/saveProject"}),{activateStep:function(t){this.setActiveStep(t),this.saveProject({notification:!1})}})},Oi=Ci,Si=(a("86f9"),a("7e85")),Ii=a("9c54"),ji=a("56a4"),Ti=Object(c["a"])(Oi,fi,mi,!1,null,"1a5cb083",null),_i=Ti.exports;d()(Ti,{VDivider:ra["a"],VStepper:Si["a"],VStepperHeader:Ii["a"],VStepperStep:ji["a"]});var Ai=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"elevation-2 pointers-please",attrs:{id:"view"}},[a("app-osd-canvas"),a("app-annotation-canvas")],1)},Vi=[],Pi=(a("a481"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"osd-canvas"}})}),Di=[],Li={mounted:function(){this.setupOsdCanvas("osd-canvas")},methods:Object(k["a"])({},Object(x["b"])({setupOsdCanvas:"image/setupOsdCanvas"}))},Ei=Li,Mi=(a("dfa3"),Object(c["a"])(Ei,Pi,Di,!1,null,null,null)),Wi=Mi.exports,Fi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("canvas",{attrs:{id:"annotation-canvas"}})},Bi=[],Ri={mounted:function(){I.a.setup("annotation-canvas"),document.getElementById("pan").click()}},Ni=Ri,Zi=(a("89cf"),Object(c["a"])(Ni,Fi,Bi,!1,null,null,null)),zi=Zi.exports,$i={components:{"app-osd-canvas":Wi,"app-annotation-canvas":zi},computed:Object(k["a"])({},Object(x["d"])({projectImageName:function(t){return t.image.projectImageName}})),mounted:function(){this.projectImageName?this.loadProject():this.$router.replace("/")},methods:Object(k["a"])({},Object(x["b"])({loadProject:"app/loadProject"}))},Gi=$i,Ui=(a("7751"),Object(c["a"])(Gi,Ai,Vi,!1,null,"4a6ec4a6",null)),Hi=Ui.exports,Ki=function(){var t=this,e=t.$createElement,a=t._self._c||e;return-1===["loading"].indexOf(t.$route.name)?a("v-toolbar",{staticClass:"primary pointers-please",attrs:{fixed:"",dark:"",dense:"",app:"","clipped-right":"","clipped-left":""}},[a("div",{attrs:{id:"toolbar-toggle"}},[a("v-toolbar-side-icon",{on:{click:function(e){return t.toggleToolsDrawer()}}})],1),a("v-toolbar-title",{staticClass:"white--text"},[t._v("\n    AIDA\n  ")]),a("v-spacer"),a("app-save"),a("v-btn",{attrs:{icon:"",to:"/"}},[a("v-icon",[t._v("\n        apps\n      ")])],1),a("v-btn",{attrs:{icon:"",href:"https://github.com/alanaberdeen/AIDA/wiki"}},[a("v-icon",{attrs:{small:""}},[t._v(" fa-book ")])],1),a("div",[a("v-toolbar-side-icon",{on:{click:function(e){return t.toggleStudioDrawer()}}})],1)],1):t._e()},qi=[],Ji=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-dialog",{staticClass:"pointers-please",attrs:{"max-width":"900"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[a("v-icon",[t._v("\n        settings\n      ")])],1),a("v-card",[a("v-container",{attrs:{id:"container"}},[a("v-layout",[a("v-navigation-drawer",{attrs:{permanent:""}},[a("v-toolbar",{staticClass:"transparent",attrs:{flat:""}},[a("v-list",{staticClass:"pa-0"},[a("v-list-tile",{attrs:{avatar:""}},[a("v-list-tile-avatar",[a("v-icon",[t._v(" settings ")])],1),a("v-list-tile-content",[a("v-list-tile-title",[t._v("Settings")])],1)],1)],1)],1),a("v-list",[a("v-divider"),a("v-list-tile",{class:["project"===t.settings?"faIconsActive":"faIcons"],on:{click:function(e){t.settings="project"}}},[a("v-list-tile-action",[a("v-icon")],1),a("v-list-tile-content",[a("v-list-tile-title",[t._v(" Project ")])],1)],1),a("v-list-tile",{class:["annotation"===t.settings?"faIconsActive":"faIcons"],on:{click:function(e){t.settings="annotation"}}},[a("v-list-tile-action",[a("v-icon")],1),a("v-list-tile-content",[a("v-list-tile-title",[t._v(" Upload Annotation ")])],1)],1),a("v-list-tile",{class:["image"===t.settings?"faIconsActive":"faIcons"],on:{click:function(e){t.settings="image"}}},[a("v-list-tile-action",[a("v-icon")],1),a("v-list-tile-content",[a("v-list-tile-title",[t._v(" Add an Image ")])],1)],1),a("v-list-tile",{class:["steps"===t.settings?"faIconsActive":"faIcons"],on:{click:function(e){t.settings="steps"}}},[a("v-list-tile-action",[a("v-icon")],1),a("v-list-tile-content",[a("v-list-tile-title",[t._v(" Steps ")])],1)],1),a("v-list-tile",{class:["tools"===t.settings?"faIconsActive":"faIcons"],on:{click:function(e){t.settings="tools"}}},[a("v-list-tile-action",[a("v-icon")],1),a("v-list-tile-content",[a("v-list-tile-title",[t._v(" Tools ")])],1)],1)],1)],1),a("div",{attrs:{id:"content"}},["project"===t.settings?a("app-project-settings"):t._e(),"annotation"===t.settings?a("app-annotation-settings"):t._e(),"image"===t.settings?a("app-image-settings"):t._e(),"steps"===t.settings?a("app-step-settings"):t._e(),"tools"===t.settings?a("app-tool-settings"):t._e()],1)],1),a("v-divider"),a("v-layout",{attrs:{"justify-end":""}},[a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("\n            Close\n          ")])],1)],1)],1)],1)],1)},Xi=[],Yi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-layout",[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{value:t.projectName,name:"input-3",label:"Project Name"},on:{change:t.setProjectName},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.setProjectName(e)}}})],1)],1)],1)},Qi=[],tn={computed:Object(k["a"])({},Object(x["d"])({projectName:function(t){return t.annotation.project.name}})),methods:Object(k["a"])({},Object(x["b"])({setProjectName:"annotation/setProjectName"}))},en=tn,an=Object(c["a"])(en,Yi,Qi,!1,null,null,null),nn=an.exports;d()(an,{VContainer:ge["a"],VFlex:Lt["a"],VLayout:be["a"],VTextField:Ft["a"]});var on=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-layout",[a("v-flex",{attrs:{xs12:""}},[t._v("\n\n      Plan to add upload functionality for annotation data.\n\n    ")])],1)],1)},rn=[],sn={computed:Object(k["a"])({},Object(x["d"])({viewSize:function(t){return t.image.view.viewSize},imageZoom:function(t){return t.image.view.imageZoom},imageCenter:function(t){return t.image.view.imageCenter}}))},ln=sn,cn=Object(c["a"])(ln,on,rn,!1,null,null,null),un=cn.exports;d()(cn,{VContainer:ge["a"],VFlex:Lt["a"],VLayout:be["a"]});var dn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-layout",[a("v-flex",{attrs:{xs12:""}},[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-text-field",{attrs:{rules:t.nameRules,label:"Name",required:""},model:{value:t.newName,callback:function(e){t.newName=e},expression:"newName"}}),a("v-radio-group",{model:{value:t.newType,callback:function(e){t.newType=e},expression:"newType"}},[a("v-radio",{attrs:{label:"Simple",value:"simple"}}),a("v-radio",{attrs:{label:"DZI",value:"dzi"}})],1),a("v-text-field",{attrs:{rules:t.sourceRules,label:"Source",required:""},model:{value:t.newSource,callback:function(e){t.newSource=e},expression:"newSource"}}),a("v-btn",{attrs:{disabled:!t.valid},on:{click:function(e){return t.loadImages([{name:t.newName,type:t.newType,source:t.newSource}])}}},[t._v("\n          submit\n        ")])],1)],1)],1)],1)},pn=[],vn={data:function(){return{valid:!1,newName:"",nameRules:[function(t){return!!t||"Name is required"}],newType:"simple",newSource:"",sourceRules:[function(t){return!!t||"Source location is required"}]}},computed:Object(k["a"])({},Object(x["d"])({viewer:function(t){return t.image.OSDviewer}}),Object(x["c"])({getChannels:"images/getChannels"})),methods:Object(k["a"])({},Object(x["b"])({loadImages:"images/loadImages"}),{submit:function(){this.$refs.form.validate()&&console.log("good to go")}})},hn=vn,fn=a("4bd4"),mn=a("67b6"),gn=a("43a6"),bn=Object(c["a"])(hn,dn,pn,!1,null,null,null),yn=bn.exports;d()(bn,{VBtn:_["a"],VContainer:ge["a"],VFlex:Lt["a"],VForm:fn["a"],VLayout:be["a"],VRadio:mn["a"],VRadioGroup:gn["a"],VTextField:Ft["a"]});var wn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v("\n  Tools\n")])},kn=[],xn={props:{editor:{type:Object,default:function(){return{}}}}},Cn=xn,On=Object(c["a"])(Cn,wn,kn,!1,null,null,null),Sn=On.exports,In=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v("\n  Steps\n")])},jn=[],Tn={props:{editor:{type:Object,default:function(){return{}}},step:{type:Number,default:1}},data:function(){return{title:""}}},_n=Tn,An=(a("dc2a"),Object(c["a"])(_n,In,jn,!1,null,"4e5a9117",null)),Vn=An.exports,Pn={components:{"app-project-settings":nn,"app-annotation-settings":un,"app-image-settings":yn,"app-step-settings":Vn,"app-tool-settings":Sn},data:function(){return{dialog:!1,settings:"project"}}},Dn=Pn,Ln=(a("0eab"),a("c954")),En=Object(c["a"])(Dn,Ji,Xi,!1,null,"347b9618",null),Mn=En.exports;d()(En,{VBtn:_["a"],VCard:Dt["a"],VContainer:ge["a"],VDialog:Ya["a"],VDivider:ra["a"],VIcon:F["a"],VLayout:be["a"],VList:Et["a"],VListTile:A["a"],VListTileAction:ye["a"],VListTileAvatar:Ln["a"],VListTileContent:we["a"],VListTileTitle:we["b"],VNavigationDrawer:sa["a"],VToolbar:ga["a"]});var Wn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{staticStyle:{height:"48px"},attrs:{row:"",shrink:""}},[t.saveState.changesSaved?t._e():a("v-layout",{attrs:{"align-center":"","justify-center":"",column:"","fill-height":"",caption:""}},[a("div",[t._v("\n      Unsaved changes.\n    ")]),t.saveState.lastSaveTimeStamp?a("div",[t._v("\n      Last save: "+t._s(this.saveState.lastSaveTimeStamp.toLocaleTimeString())+"\n    ")]):t._e()]),a("v-layout",{attrs:{shrink:""}},[a("v-btn",{attrs:{id:"save-button",icon:""},nativeOn:{click:function(e){return t.save()}}},[t.savingInProgress?a("v-progress-circular",{attrs:{indeterminate:"",color:"white",size:20}}):a("v-icon",[t._v("\n        save\n      ")])],1)],1)],1)},Fn=[],Bn={data:function(){return{savingInProgress:!1}},computed:Object(k["a"])({},Object(x["d"])({saveState:function(t){return t.annotation.saveState}})),mounted:function(){window.addEventListener("keydown",this.keyDown),window.addEventListener("beforeunload",this.checkForUnsavedChanges)},methods:Object(k["a"])({},Object(x["b"])({dispatchSave:"backend/saveAnnotation"}),{save:function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.savingInProgress=!0,t.next=3,this.dispatchSave();case 3:this.savingInProgress=!1;case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),checkForUnsavedChanges:function(t){this.saveState.changesSaved||(t.preventDefault(),t.returnValue="Annotation data has not been saved")},keyDown:function(t){"s"!==t.key||!0!==t.metaKey&&!0!==t.ctrlKey||(t.preventDefault(),document.getElementById("save-button").click())}})},Rn=Bn,Nn=a("490a"),Zn=Object(c["a"])(Rn,Wn,Fn,!1,null,null,null),zn=Zn.exports;d()(Zn,{VBtn:_["a"],VIcon:F["a"],VLayout:be["a"],VProgressCircular:Nn["a"]});var $n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-btn",{attrs:{icon:""},nativeOn:{click:function(e){return t.exportData(e)}}},[a("v-icon",{attrs:{small:""}},[t._v("\n    fa-download\n  ")])],1)},Gn=[],Un={computed:Object(k["a"])({},Object(x["d"])({dataToExport:function(t){return t.annotation.project}})),methods:Object(k["a"])({},Object(x["b"])({refreshAnnotationState:"annotation/refreshAnnotationState"}),{exportData:function(){this.refreshAnnotationState();var t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(this.dataToExport,null,2)),e=document.createElement("a");e.setAttribute("href",t),e.setAttribute("download","AIDA_annotation.json"),document.body.appendChild(e),e.click(),e.remove()}})},Hn=Un,Kn=Object(c["a"])(Hn,$n,Gn,!1,null,null,null),qn=Kn.exports;d()(Kn,{VBtn:_["a"],VIcon:F["a"]});var Jn={components:{"app-settings":Mn,"app-save":zn,"app-export":qn},methods:Object(k["a"])({},Object(x["b"])({toggleToolsDrawer:"app/toggleToolsDrawer",toggleStudioDrawer:"app/toggleStudioDrawer"}))},Xn=Jn,Yn=(a("32e4"),a("706c")),Qn=Object(c["a"])(Xn,Ki,qi,!1,null,"4f76ba3a",null),to=Qn.exports;d()(Qn,{VBtn:_["a"],VIcon:F["a"],VSpacer:Pa["a"],VToolbar:ga["a"],VToolbarSideIcon:Yn["a"],VToolbarTitle:ba["a"]});var eo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-snackbar",{attrs:{value:t.active,color:t.color,timeout:0,top:""}},[t._v("\n  "+t._s(t.text)+"\n")])},ao=[],io={computed:Object(k["a"])({},Object(x["d"])({active:function(t){return t.app.snackbar.active},text:function(t){return t.app.snackbar.text},color:function(t){return t.app.snackbar.color},timeout:function(t){return t.app.snackbar.timeout}})),methods:Object(k["a"])({},Object(x["b"])({dismissSnackbar:"app/dismissSnackbar"})),watch:{active:function(t){var e=this;t&&this.timeout>0&&setTimeout(function(){e.dismissSnackbar()},this.timeout)}}},no=io,oo=a("2db4"),ro=Object(c["a"])(no,eo,ao,!1,null,null,null),so=ro.exports;d()(ro,{VSnackbar:oo["a"]});var lo={components:{"app-tools":ca,"app-studio":hi,"app-stepper":_i,"app-view":Hi,"app-toolbar":to,"app-snackbar":so}},co=lo,uo=(a("7f95"),Object(c["a"])(co,g,b,!1,null,"f3e000ee",null)),po=uo.exports,vo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-toolbar",{staticClass:"primary pointers-please",attrs:{fixed:"",dark:"",dense:"",app:""}},[a("v-toolbar-title",{staticClass:"white--text"},[t._v("\n      AIDA\n    ")]),a("v-spacer"),a("v-btn",{attrs:{icon:"",to:"/"}},[a("v-icon",[t._v("\n        apps\n      ")])],1),a("v-btn",{attrs:{icon:"",href:"https://github.com/alanaberdeen/AIDA/wiki"}},[a("v-icon",{attrs:{small:""}},[t._v(" fa-book ")])],1)],1),a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs10:"","offset-xs1":""}},[a("Treeview")],1)],1)],1)],1)},ho=[],fo=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{staticClass:"mx-auto"},[a("v-sheet",{staticClass:"pa-3 primary lighten-2"},[a("v-text-field",{attrs:{label:"Search for an image",dark:"",flat:"","solo-inverted":"","hide-details":"",clearable:"","clear-icon":"mdi-close-circle-outline"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),a("v-checkbox",{attrs:{dark:"","hide-details":"",label:"Case sensitive search"},model:{value:t.caseSensitive,callback:function(e){t.caseSensitive=e},expression:"caseSensitive"}})],1),a("v-card-text",[a("v-treeview",{attrs:{open:t.open,items:t.items,search:t.search,filter:t.filter,"item-key":"name"},scopedSlots:t._u([{key:"prepend",fn:function(e){var i=e.item,n=e.open;return[i.ext?a("v-icon",[t._v("\n          "+t._s(t.files[i.ext])+"\n        ")]):a("v-icon",[t._v("\n          "+t._s(n?"mdi-folder-open":"mdi-folder")+"\n        ")])]}},{key:"label",fn:function(e){var i=e.item;return[!i.children&&t.loadableImageTypes.includes(i.ext)?a("router-link",{attrs:{to:{name:"loading",params:{filePath:i.path}}}},[t._v("\n          "+t._s(i.name)+"\n        ")]):i.children||t.loadableImageTypes.includes(i.ext)?a("span",[t._v(" "+t._s(i.name)+" ")]):a("span",{staticClass:"grey--text"},[t._v(" \n          "+t._s(i.name)+" \n        ")])]}}]),model:{value:t.tree,callback:function(e){t.tree=e},expression:"tree"}})],1)],1)},mo=[],go=a("bd86"),bo={data:function(){var t;return{files:(t={".html":"mdi-language-html5",".js":"mdi-nodejs",".json":"mdi-json",".md":"mdi-markdown",".pdf":"mdi-file-pdf",".png":"mdi-file-image",".txt":"mdi-file-document-outline",".xls":"mdi-file-excel",".dzi":"image_search",".jpg":"mdi-image-outline"},Object(go["a"])(t,".png","mdi-image-outline"),Object(go["a"])(t,".ndpi","mdi-image-off"),t),loadableImageTypes:[".dzi",".png",".jpg"],tree:[],open:["public"],search:null,caseSensitive:!1}},computed:Object(k["a"])({filter:function(){return this.caseSensitive?function(t,e,a){return t[a].indexOf(e)>-1}:void 0}},Object(x["d"])({items:function(t){return t.backend.availableImages}}))},yo=bo,wo=(a("20d6"),a("99d9")),ko=a("ac7c"),xo=a("8dd9"),Co=a("eb2a"),Oo=Object(c["a"])(yo,fo,mo,!1,null,"3a1aa438",null),So=Oo.exports;d()(Oo,{VCard:Dt["a"],VCardText:wo["a"],VCheckbox:ko["a"],VIcon:F["a"],VSheet:xo["a"],VTextField:Ft["a"],VTreeview:Co["a"]});var Io={components:{Toolbar:to,Treeview:So},mounted:function(){this.getArrayOfImages()},methods:Object(k["a"])({},Object(x["b"])({getArrayOfImages:"backend/getArrayOfImages"}))},jo=Io,To=Object(c["a"])(jo,vo,ho,!1,null,null,null),_o=To.exports;d()(To,{VBtn:_["a"],VContainer:ge["a"],VFlex:Lt["a"],VIcon:F["a"],VLayout:be["a"],VSpacer:Pa["a"],VToolbar:ga["a"],VToolbarTitle:ba["a"]});var Ao=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"container"}},[a("v-content",[a("v-container",{attrs:{fluid:"","fill-height":""}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-flex",{attrs:{xs10:"",sm6:"",md4:""}},[a("div",[a("p",{staticClass:"display-3 faded-title-text mb-0"},[t._v(" AIDA ")]),a("p",{staticClass:"headline faded-title-text pt-0"},[t._v(" Annotate Image Data by Assignment ")]),a("v-progress-linear",{attrs:{indeterminate:!0}})],1)])],1)],1)],1)],1)},Vo=[],Po=a("df7c"),Do=a.n(Po),Lo={props:{fileName:{type:String,default:null}},methods:Object(k["a"])({},Object(x["b"])({setProjectImageName:"image/setProjectImageName",setProjectFilePath:"backend/setProjectFilePath"})),computed:Object(x["d"])({projectImageName:function(t){return t.image.projectImageName}}),mounted:function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e=Do.a.extname(this.$route.params.filePath),t.next=4,this.setProjectImageName(Do.a.basename(this.$route.params.filePath,e));case 4:return t.next=6,this.setProjectFilePath(this.$route.params.filePath);case 6:this.$router.replace("/edit?q="+this.$route.params.filePath),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log("could not load the data into AIDA"),console.log(t.t0);case 13:case"end":return t.stop()}},t,this,[[0,9]])}));function e(){return t.apply(this,arguments)}return e}()},Eo=Lo,Mo=(a("a4dd"),a("8e36")),Wo=Object(c["a"])(Eo,Ao,Vo,!1,null,"5d8df761",null),Fo=Wo.exports;d()(Wo,{VContainer:ge["a"],VContent:v["a"],VFlex:Lt["a"],VLayout:be["a"],VProgressLinear:Mo["a"]}),i["a"].use(m["a"]);var Bo=new m["a"]({mode:"history",base:"/",routes:[{path:"/",name:"Dashboard",component:_o},{path:"/edit",name:"editor",component:po,props:function(t){return{query:t.query.q}}},{path:"/loading/:filePath",name:"loading",component:Fo}]}),Ro=(a("7514"),a("28a5"),a("c51a")),No=a.n(Ro),Zo={getArrayOfImages:function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(e){var a,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.commit,t.prev=1,t.next=4,Ie.a.post("http://localhost:3000/checkForImages");case 4:return i="http://localhost:3000/data/images.json",t.next=7,Ie.a.get(i);case 7:n=t.sent,a("setAvailableImages",n.data),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),console.log(t.t0);case 14:case"end":return t.stop()}},t,null,[[1,11]])}));function e(e){return t.apply(this,arguments)}return e}(),saveAnnotation:function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(e){var a,i,n,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.state,i=e.dispatch,n=e.rootState,t.prev=1,t.next=4,i("annotation/refreshAnnotationState",null,{root:!0});case 4:return o="http://localhost:3000/save",t.next=7,Ie.a.post(o,{projectFilePath:a.projectFilePath,annotationData:n.annotation.project});case 7:i("app/activateSnackbar",{text:"Saved annotation data",color:"success"},{root:!0}),i("annotation/setSaveState",{changesSaved:!0,lastSaveTimeStamp:new Date},{root:!0}),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](1),console.log(t.t0),i("app/activateSnackbar",{text:"Annotation data could not be saved",color:"error"},{root:!0});case 15:case"end":return t.stop()}},t,null,[[1,11]])}));function e(e){return t.apply(this,arguments)}return e}(),getAnnotation:function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(e){var a,i,n,o,r,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.state,i=e.dispatch,e.rootState,n=Do.a.extname(a.projectFilePath),o=a.projectFilePath.split(n)[0],r="http://localhost:3000/annotations/"+o+".json",t.prev=4,t.next=7,Ie.a.get(r);case 7:s=t.sent,i("annotation/loadAnnotation",s.data,{root:!0}),t.next=16;break;case 11:t.prev=11,t.t0=t["catch"](4),console.log("Annotation data either could not be found or could not be loaded"),console.log("Loading the default empty project"),i("annotation/loadAnnotation",null,{root:!0});case 16:case"end":return t.stop()}},t,null,[[4,11]])}));function e(e){return t.apply(this,arguments)}return e}(),setProjectFilePath:function(t,e){var a=t.commit;a("setProjectFilePath",e)},getProjectImage:function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(e){var a,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.state,i=e.rootState,n=e.dispatch,t.next=3,n("image/clearImages",null,{root:!0});case 3:a.projectFilePath.indexOf(".dzi")>-1?(n("image/addOSDImage",{name:i.image.projectImageName,fileType:"dzi",source:"http://localhost:3000/images/"+a.projectFilePath,function:"project",opacity:1},{root:!0}),n("getProjectImageProperties")):n("image/addOSDImage",{name:i.image.projectImageName,fileType:"simple",source:"http://localhost:3000/images/"+a.projectFilePath,function:"project",opacity:1},{root:!0});case 4:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),getProjectImageProperties:function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(e){var a,i,n,o,r,s,l;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.state,i=e.dispatch,n="http://localhost:3000/images/"+a.projectFilePath.slice(0,-4)+"_files/vips-properties.xml",t.next=4,fetch(n);case 4:return o=t.sent,t.t0=JSON,t.t1=No.a,t.next=9,o.text();case 9:t.t2=t.sent,t.t3={ignoreDeclaration:!0,compact:!0,ignoreComment:!0,alwaysChildren:!0,attributesKey:"attributes",textKey:"text"},t.t4=t.t1.xml2json.call(t.t1,t.t2,t.t3),r=t.t0.parse.call(t.t0,t.t4),s=Number(r.image.properties.property.find(function(t){return"openslide.mpp-x"===t.name.text}).value.text),l=Number(r.image.properties.property.find(function(t){return"openslide.mpp-y"===t.name.text}).value.text),i("image/setPixelScaleFactor",{mppX:s,mppY:l},{root:!0});case 16:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()},zo={setAvailableImages:function(t,e){t.availableImages=e},setProjectFilePath:function(t,e){t.projectFilePath=e}},$o={availableImages:[],projectFilePath:""},Go={namespaced:!0,state:$o,actions:Zo,mutations:zo},Uo={setTask:function(t,e){var a=t.commit;a("setTask",e)},dismissSnackbar:function(t){var e=t.commit;e("dismissSnackbar")},activateSnackbar:function(t,e){var a=t.commit;a("activateSnackbar",e)},synchroniseAnnotationAndOSDCanvas:function(t){var e=t.commit,a=t.rootState;e("synchroniseAnnotationAndOSDCanvas",a.image.OSDviewer)},setActiveStepAndLayer:function(t,e){var a=t.dispatch;a("setActiveLayer",e),a("setActiveStep",e)},setActiveStep:function(t,e){var a=t.commit,i=t.dispatch;"number"===typeof e.specificLayer&&i("annotation/setActiveLayer",e.specificLayer,{root:!0}),a("setActiveStep",e.id-1)},setActiveLayer:function(t,e){var a=t.commit;a("setActiveLayer",e)},toggleSettings:function(t){var e=t.commit;e("toggleSettings")},setActiveValidationIndex:function(t,e){var a=t.commit;a("setActiveValidationIndex",e)},setupForValidation:function(t){var e=t.commit;e("setupForValidation")},loadProject:function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(e){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.dispatch,t.next=3,a("synchroniseAnnotationAndOSDCanvas");case 3:a("backend/getAnnotation",null,{root:!0}),a("backend/getProjectImage",null,{root:!0});case 5:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}(),toggleToolsDrawer:function(t){var e=t.commit;e("toggleToolsDrawer")},setToolsDrawerState:function(t,e){var a=t.commit;a("setToolsDrawerState",e)},toggleStudioDrawer:function(t){var e=t.commit;e("toggleStudioDrawer")},setStudioDrawerState:function(t,e){var a=t.commit;a("setStudioDrawerState",e)},createNewItem:function(t,e){var a=t.state,i=t.rootState,n=t.commit;e["studyName"]=a.studyName,e["imageName"]=i.image.projectImageName,n("createNewItem",e)}},Ho={setTask:function(t,e){t.task=e},activateSnackbar:function(t,e){t.snackbar.active=!0,t.snackbar.text=e.text?e.text:"notification",t.snackbar.color=e.color?e.color:"info",t.snackbar.timeout=e.timeout?e.timeout:4e3},dismissSnackbar:function(t){t.snackbar.active=!1},synchroniseAnnotationAndOSDCanvas:function(t,e){var a=t.strokeScale;e.addHandler("update-viewport",function(t){var i=e.viewport.getZoom(!0),n=e.world.getItemAt(0);I.a.view.zoom=n.viewportToImageZoom(i);var o=n.viewportToImageCoordinates(e.viewport.getCenter(!0));I.a.view.center=new I.a.Point(o.x,o.y),I.a.project.getItems({class:I.a.Path}).forEach(function(t){t.strokeWidth=n.getContentSize().x*a/(1e3*i),t.hasOwnProperty("drawLabel")&&t.drawLabel()})}),e.addHandler("resize",function(t){var a=e.world.getItemAt(0);I.a.view.viewSize.width=t.newContainerSize.x,I.a.view.viewSize.height=t.newContainerSize.y;var i=a.viewportToImageCoordinates(e.viewport.getCenter(!0));I.a.view.center=new I.a.Point(i.x,i.y)})},setActiveStep:function(t,e){t.activeStep=e},setActiveLayer:function(t,e){t.activeLayer=e},toggleSettings:function(t){t.settingsFlag=!t.settingsFlag},setActiveValidationIndex:function(t,e){t.activeValidationIndex=e},setSteps:function(t){t.toolsDrawer=!1,t.studioDrawer=!1,"review"===t.task?t.steps=[{id:1,instruction:"Review the data",type:"review"}]:"validate"===t.task?t.steps=[{id:1,instruction:"Cycle through each of the predicted Megakaryocyte classifications and verify whether the prediction is correct or incorrect. In cases where you are not certain, flag the prediction for review.",type:"validate"}]:(t.toolsDrawer=!0,t.studioDrawer=!0,t.steps=null)},toggleToolsDrawer:function(t){t.toolsDrawer=!t.toolsDrawer},toggleStudioDrawer:function(t){t.studioDrawer=!t.studioDrawer},setToolsDrawerState:function(t,e){t.toolsDrawer=e},setStudioDrawerState:function(t,e){t.studioDrawer=e}},Ko={getStepTools:function(t){return t.steps&&t.steps[t.activeStep].tools?t.steps[t.activeStep].tools:["pan","circle","rectangle","path","pencil","polygon","paint","paste","edit","move","node","count","delete","megas","filter","super-pixel","ruler"]}},qo={task:"",toolsDrawer:!0,studioDrawer:!0,snackbar:{active:!1,text:"this is a notification",color:"info",timeout:4e3},type:"dzi",activeChannel:0,activeLayer:0,activeStep:0,steps:null,settingsFlag:!1,activeValidationIndex:0,strokeScale:5},Jo={namespaced:!0,state:qo,actions:Uo,mutations:Ho,getters:Ko},Xo={getMaxZoom:function(t){return t.OSDviewer?Math.round(t.OSDviewer.viewport.getMaxZoom()):10},getZoom:function(t){if(t.OSDviewer){var e=t.OSDviewer.viewport.getZoom();return e<100?Math.round(10*e)/10:Math.round(e)}return"na"},getImageWidth:function(t){if(t.OSDviewer)return t.OSDviewer.world.getItemCount()>0?t.OSDviewer.world.getItemAt(0).getContentSize.x:0},getChannels:function(t){var e=t.images.filter(function(t){return"overlay"!==t.function});return t.OSDviewer&&t.OSDviewer.world.getItemCount()>0&&e.length>0?e.map(function(e){var a=t.OSDviewer.world.getItemAt(e.index);if(a)return{channel:a,id:e.index,opacity:a.getOpacity(),name:e.name,visible:a.getOpacity()>0,opacityCache:0}}):[]}},Yo={addOSDImage:function(t,e){var a=t.commit;a("addOSDImage",e)},clearImages:function(t){var e=t.commit;e("clearImages")},setProjectImageName:function(t,e){var a=t.commit;a("setProjectImageName",e)},setupOsdCanvas:function(t,e){var a=t.commit;a("setupOsdCanvas",e)},resetImageState:function(t){var e=t.commit,a=t.rootState;e("resetImageState",a)},setActiveChannel:function(t,e){var a=t.commit;a("setActiveChannel",e)},toggleChannelOpacity:function(t,e){var a=t.commit;a("toggleChannelOpacity",e)},setActiveChannelOpacity:function(t,e){var a=t.commit;a("setActiveChannelOpacity",e)},setActiveChannelName:function(t,e){var a=t.commit;a("setActiveChannelName",e)},setZoom:function(t,e){var a=t.commit;a("setZoom",e)},setPixelScaleFactor:function(t,e){var a=t.commit;a("setPixelScaleFactor",e)}},Qo=(a("20d62"),{setProjectImageName:function(t,e){t.projectImageName=e},resetImageState:function(t){t.OSDviewer.navigator.destroy(),t.OSDviewer.destroy(),t={OSDviewer:null,OSDworld:null,activeChannel:0,view:{viewSize:[null,null],imageSize:[null,null],imageCenter:[null,null],imageZoom:null},image:"",imageAccessToken:""}},setupOsdCanvas:function(t,e){t.OSDviewer=new ae.a.Viewer({id:e,showNavigationControl:!1,showNavigator:!0,navigatorId:"navigator",maxZoomPixelRatio:2}),t.OSDviewer.addHandler("canvas-key",function(t){"KeyR"!==t.originalEvent.code&&"KeyF"!==t.originalEvent.code||(t.preventDefaultAction=!0)})},setActiveChannel:function(t,e){"number"===typeof e?t.activeChannelIndex=e:"string"===typeof e&&(t.activeChannelIndex=t.images.findIndex(function(t){return t.name===e}))},toggleChannelOpacity:function(t,e){e.opacity>0?e.channel.setOpacity(0):e.channel.setOpacity(.7)},setActiveChannelOpacity:function(t,e){var a;a=e instanceof KeyboardEvent?e.target.value/100:e/100,a=Math.min(Math.max(a,0),1);var i=t.OSDviewer.world.getItemAt(t.activeChannelIndex);i&&i.setOpacity(a)},setActiveChannelName:function(t,e){e instanceof KeyboardEvent?i["a"].set(t.images[t.activeChannelIndex],"name",e.target.value):i["a"].set(t.images[t.activeChannelIndex],"name",e)},setZoom:function(t,e){var a;a=e instanceof KeyboardEvent?Number(e.target.value):Number(e),a>0&&t.OSDviewer.viewport.zoomTo(a)},addOSDImage:function(t,e){"dzi"===e.fileType?t.OSDviewer.addTiledImage({tileSource:e.source,opacity:e.opacity}):"simple"===e.fileType&&t.OSDviewer.addSimpleImage({url:e.source,opacity:e.opacity}),t.images.push(Object(k["a"])({},e,{index:t.OSDviewer.world.getItemCount()}))},clearImages:function(t){t.images=[]},setPixelScaleFactor:function(t,e){t.pixelScaleFactor.mppX=e.mppX,t.pixelScaleFactor.mppY=e.mppY}}),tr={OSDviewer:null,OSDworld:null,activeChannelIndex:0,projectImageName:"",images:[],pixelScaleFactor:{mppX:null,mppY:null}},er={namespaced:!0,state:tr,getters:Xo,actions:Yo,mutations:Qo},ar=(a("ac4d"),a("8a81"),{defaultColors:function(){return[{fill:{hue:170,saturation:.44,lightness:.69,alpha:.7},stroke:{hue:170,saturation:.44,lightness:.69,alpha:1}},{fill:{hue:60,saturation:1,lightness:.85,alpha:.7},stroke:{hue:60,saturation:1,lightness:.85,alpha:1}},{fill:{hue:248,saturation:.3,lightness:.79,alpha:.7},stroke:{hue:248,saturation:.3,lightness:.79,alpha:1}},{fill:{hue:6,saturation:.94,lightness:.72,alpha:.7},stroke:{hue:6,saturation:.94,lightness:.72,alpha:1}},{fill:{hue:205,saturation:.49,lightness:.66,alpha:.7},stroke:{hue:205,saturation:.49,lightness:.66,alpha:1}},{fill:{hue:32,saturation:.97,lightness:.69,alpha:.7},stroke:{hue:32,saturation:.97,lightness:.69,alpha:1}},{fill:{hue:82,saturation:.64,lightness:.64,alpha:.7},stroke:{hue:82,saturation:.64,lightness:.64,alpha:1}},{fill:{hue:329,saturation:.89,lightness:.9,alpha:.7},stroke:{hue:329,saturation:.89,lightness:.9,alpha:1}},{fill:{hue:0,saturation:0,lightness:.85,alpha:.7},stroke:{hue:0,saturation:0,lightness:.85,alpha:1}},{fill:{hue:299,saturation:.32,lightness:.62,alpha:.7},stroke:{hue:299,saturation:.32,lightness:.62,alpha:1}}]},drawItem:function(t){var e;if(t)if("circle"===t.type)e=new I.a.Path.Circle({center:t.center,radius:t.radius,data:{type:"circle",countable:!0,class:t.class,data:t.data},locked:t.locked}),this.drawItemColor(e,t);else if("rectangle"===t.type)e=new I.a.Path.Rectangle({point:[t.x,t.y],size:[t.width,t.height],data:{type:"rectangle",class:t.class,data:t.data},locked:t.locked}),this.drawItemColor(e,t);else if("path"===t.type)e=new I.a.Path({segments:t.segments,closed:!!t.closed&&t.closed,data:{type:"path",class:t.class,data:t.data},locked:t.locked}),this.drawItemColor(e,t);else if("raster"===t.type){var a=t.hasOwnProperty("position")?new I.a.Point(t.position.x,t.position.y):new I.a.Point(0,0);e=new I.a.Raster({crossOrigin:"anonymous",source:t.source,position:a,data:{type:"raster",countable:!1,class:t.class,data:t.data},locked:t.locked})}},getSegments:function(t){for(var e=[],a=0,i=t.segments.length;a<i;a++){var n=t.segments[a];n.hasHandles()?e.push({point:{x:n.point.x,y:n.point.y},handleIn:{x:n.handleIn.x,y:n.handleIn.y},handleOut:{x:n.handleOut.x,y:n.handleOut.y}}):e.push({point:{x:n.point.x,y:n.point.y}})}return e},getColor:function(t){return{fill:t.fillColor?{hue:t.fillColor.hue,saturation:t.fillColor.saturation,lightness:t.fillColor.lightness,alpha:t.fillColor.alpha}:null,stroke:t.strokeColor?{hue:t.strokeColor.hue,saturation:t.strokeColor.saturation,lightness:t.strokeColor.lightness,alpha:t.strokeColor.alpha}:null}},drawItemColor:function(t,e){var a=this.defaultColors();t.closed&&e.color&&e.color.fill&&("string"===typeof e.color.fill?(t.fillColor=e.color.fill,t.fillColor.alpha=.2):t.fillColor=new I.a.Color({hue:e.color.fill.hue,saturation:e.color.fill.saturation,lightness:e.color.fill.lightness,alpha:e.color.fill.alpha})),e.color&&e.color.stroke?"string"===typeof e.color.stroke?t.strokeColor=e.color.stroke:t.strokeColor=new I.a.Color({hue:e.color.stroke.hue,saturation:e.color.stroke.saturation,lightness:e.color.stroke.lightness,alpha:e.color.stroke.alpha}):t.strokeColor=a[t.layer.index%a.length].stroke}}),ir={loadAnnotation:function(){var t=Object(Be["a"])(regeneratorRuntime.mark(function t(e,a){var i,n,o,r,s,l,c,u,d,p,v,h,f,m;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(i=e.dispatch,n=e.commit,n("resetProjectState"),!a){t.next=70;break}o=!0,r=!1,s=void 0,t.prev=6,l=a.layers[Symbol.iterator]();case 8:if(o=(c=l.next()).done){t.next=53;break}return u=c.value,t.next=12,i("createLayer");case 12:return t.next=14,i("setActiveLayerName",u.name);case 14:return t.next=16,i("setActiveLayerType",u.type);case 16:d=!0,p=!1,v=void 0,t.prev=19,h=u.items[Symbol.iterator]();case 21:if(d=(f=h.next()).done){t.next=35;break}if(m=f.value,"overlay"!==m.type){t.next=31;break}return t.next=26,i("image/addOSDImage",{function:"overlay",fileType:m.fileType,source:m.source,name:u.name,opacity:u.opacity},{root:!0});case 26:return t.next=28,i("image/setActiveChannel",u.name,{root:!0});case 28:n("addItemToActiveLayer",m),t.next=32;break;case 31:ar.drawItem(m);case 32:d=!0,t.next=21;break;case 35:t.next=41;break;case 37:t.prev=37,t.t0=t["catch"](19),p=!0,v=t.t0;case 41:t.prev=41,t.prev=42,d||null==h.return||h.return();case 44:if(t.prev=44,!p){t.next=47;break}throw v;case 47:return t.finish(44);case 48:return t.finish(41);case 49:i("setActiveLayerOpacity",100*u.opacity);case 50:o=!0,t.next=8;break;case 53:t.next=59;break;case 55:t.prev=55,t.t1=t["catch"](6),r=!0,s=t.t1;case 59:t.prev=59,t.prev=60,o||null==l.return||l.return();case 62:if(t.prev=62,!r){t.next=65;break}throw s;case 65:return t.finish(62);case 66:return t.finish(59);case 67:a.activeLayer&&i("setActiveLayer",a.activeLayer),t.next=74;break;case 70:return t.next=72,i("createLayer");case 72:i("setActiveLayerName","Layer 1"),i("setActiveLayerType","paths");case 74:case"end":return t.stop()}},t,null,[[6,55,59,67],[19,37,41,49],[42,,44,48],[60,,62,66]])}));function e(e,a){return t.apply(this,arguments)}return e}(),resetAnnotationState:function(t){var e=t.commit;e("resetAnnotationState")},refreshAnnotationState:function(t,e){var a=t.commit;a("refreshAnnotationState",e)},prepareCanvas:function(t){var e=t.commit,a=t.rootState;e("prepareCanvas",a.app.activeLayer)},createLayer:function(t){var e=t.commit;e("createLayer")},setActiveLayer:function(t,e){var a=t.state,i=t.dispatch;if(I.a.project.layers[e].activate(),i("app/setActiveLayer",e,{root:!0}),"overlay"===a.project.layers[e].type){var n=a.project.layers[e].name;i("image/setActiveChannel",n,{root:!0})}},setActiveLayerOpacity:function(t,e){var a=t.state,i=t.dispatch,n=t.commit;n("setActiveLayerOpacity",e);var o=I.a.project.activeLayer.index;"overlay"===a.project.layers[o].type&&i("image/setActiveChannelOpacity",e,{root:!0})},setActiveLayerName:function(t,e){var a=t.commit;a("setActiveLayerName",e)},setActiveLayerType:function(t,e){var a=t.commit;a("setActiveLayerType",e)},deleteActiveLayer:function(t){var e=t.commit;e("deleteActiveLayer")},setProjectName:function(t,e){var a=t.commit;a("setProjectName",e)},setSelectedItems:function(t,e){var a=t.commit;a("setSelectedItems",e)},drawBoundingBoxes:function(t,e){var a=t.commit;a("drawBoundingBoxes",e)},setSaveState:function(t,e){var a=t.commit;a("setSaveState",e)},flagAnnotationEdits:function(t){var e=t.commit;e("setSaveState",{changesSaved:!1})}},nr={resetProjectState:function(t){i["a"].set(t,"project",{name:"An AIDA project",layers:[]})},addItemToActiveLayer:function(t,e){var a=t.project.layers[I.a.project.activeLayer.index];a.items.push(e)},refreshAnnotationState:function(t){I.a.project.layers.forEach(function(e){var a=t.project.layers[e.index];i["a"].set(t.project.layers,e.index,{name:a.name,opacity:e.opacity,type:a.type,items:a.items.filter(function(t){return"overlay"===t.type})})});var e=I.a.project.getItems({className:function(t){return"Path"===t||"Raster"===t}}),a=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var l=r.value;if("circle"===l.data.type)t.project.layers[l.layer.index].items.push({class:l.data.class,type:"circle",color:ar.getColor(l),center:{x:l.position.x,y:l.position.y},radius:l.bounds.width/2,locked:l.locked,data:l.data.data});else if("rectangle"===l.data.type)t.project.layers[l.layer.index].items.push(Object(k["a"])({},l.data,{color:ar.getColor(l),x:l.bounds.x,y:l.bounds.y,width:l.bounds.width,height:l.bounds.height,locked:l.locked}));else if("path"===l.data.type)t.project.layers[l.layer.index].items.push({class:l.data.class,type:"path",color:ar.getColor(l),segments:ar.getSegments(l),closed:l.closed,locked:l.locked,data:l.data.data});else if("imageEdit"===l.data.type){var c=l.rasterize(),u=c.toDataURL();t.project.layers[l.layer.index].items.push({class:l.data.class,type:"raster",source:u,position:{x:l.position.x,y:l.position.y},data:l.data.data})}else if("raster"===l.data.type){var d=l.layer.getItems({match:function(t){return t.locked},overlapping:l.bounds});d.unshift(l);var p=new I.a.Group(d);p.sendToBack();var v=p.rasterize(l.resolution.height,!1),h=v.toDataURL();t.project.layers[l.layer.index].items.push({class:l.data.class,type:"raster",source:h,position:{x:l.position.x,y:l.position.y},data:l.data.data})}}}catch(f){n=!0,o=f}finally{try{a||null==s.return||s.return()}finally{if(n)throw o}}t.projectStateRefreshIndex=t.projectStateRefreshIndex+1},prepareCanvas:function(t,e){I.a.view.element.classList.contains("pointers-no")&&I.a.view.element.classList.remove("pointers-no"),e&&I.a.project.layers[e].activate()},createLayer:function(t){var e=new I.a.Layer;t.project.layers.push({name:"Layer "+(t.project.layers.length+1),opacity:e.opacity,items:[]})},setActiveLayerOpacity:function(t,e){var a=e instanceof KeyboardEvent?e.target.value/100:e/100;a=Math.min(Math.max(a,0),1),I.a.project.activeLayer.opacity=a,i["a"].set(t.project.layers[I.a.project.activeLayer.index],"opacity",a)},setActiveLayerName:function(t,e){var a=e instanceof KeyboardEvent?e.target.value:e;I.a.project.activeLayer.name=a,i["a"].set(t.project.layers[I.a.project.activeLayer.index],"name",a)},setActiveLayerType:function(t,e){i["a"].set(t.project.layers[I.a.project.activeLayer.index],"type",e)},deleteActiveLayer:function(t){t.project.layers.splice(I.a.project.activeLayer.index,1),I.a.project.activeLayer.remove()},setProjectName:function(t,e){e instanceof KeyboardEvent?t.project.name=e.target.value:t.project.name=e},setSelectedItems:function(t,e){t.selectedItems=e},drawBoundingBoxes:function(t,e){var a=new I.a.Layer({name:"Validate"});a.opacity=1,e.forEach(function(e){var a=new I.a.Path.Rectangle({point:[e.boundingBox.x,e.boundingBox.y],size:[e.boundingBox.width,e.boundingBox.height],data:{name:e.name,type:"rectangle",predictionClass:e.class.predictionClass,predictionScore:e.class.predictionScore,validationClass:e.class.validationClass,validationScore:e.class.validationScore}});a.strokeColor=t.defaultColors[a.layer.index%t.defaultColors.length].stroke})},setSaveState:function(t,e){t.saveState.changesSaved=e.changesSaved,e.lastSaveTimeStamp&&(t.saveState.lastSaveTimeStamp=e.lastSaveTimeStamp)}},or={getColor:function(t,e,a){var i=a.app.activeLayer;return t.defaultColors[i%t.defaultColors.length]},getItemsForValidation:function(t){var e=t.project.layers.filter(function(t){return"Validate"===t.name});return e.length>0?e[0].items:[]}},rr={project:{name:"An AIDA project",layers:[]},projectStateRefreshIndex:0,selectedItems:[],currentColor:null,defaultColors:ar.defaultColors(),saveState:{changesSaved:!0,lastSaveTimeStamp:null}},sr={namespaced:!0,state:rr,getters:or,actions:ir,mutations:nr};i["a"].use(x["a"]);var lr=new x["a"].Store({modules:{backend:Go,app:Jo,image:er,annotation:sr}});a("585e"),a("5363"),a("15f5");i["a"].config.productionTip=!1,new i["a"]({router:Bo,store:lr,render:function(t){return t(f)}}).$mount("#app")},"585e":function(t,e,a){},"5b49":function(t,e,a){},"6b5f":function(t,e,a){},"6bba":function(t,e,a){},"6def":function(t,e,a){},"748c":function(t,e,a){},"74f9":function(t,e,a){"use strict";var i=a("a2fc"),n=a.n(i);n.a},7751:function(t,e,a){"use strict";var i=a("30cc"),n=a.n(i);n.a},"79de":function(t,e,a){},"7db0":function(t,e,a){"use strict";var i=a("af50"),n=a.n(i);n.a},"7f95":function(t,e,a){"use strict";var i=a("a032"),n=a.n(i);n.a},"816d":function(t,e,a){},8381:function(t,e,a){},"86f9":function(t,e,a){"use strict";var i=a("816d"),n=a.n(i);n.a},"882c":function(t,e,a){"use strict";var i=a("d7e8"),n=a.n(i);n.a},"89cf":function(t,e,a){"use strict";var i=a("79de"),n=a.n(i);n.a},"8b38":function(t,e,a){"use strict";var i=a("6b5f"),n=a.n(i);n.a},"8cc7":function(t,e,a){},"9a0c":function(t,e,a){},"9d7a":function(t,e,a){"use strict";var i=a("46c1"),n=a.n(i);n.a},a032:function(t,e,a){},a2fc:function(t,e,a){},a45a:function(t,e,a){"use strict";var i=a("ab99"),n=a.n(i);n.a},a4dd:function(t,e,a){"use strict";var i=a("cd21"),n=a.n(i);n.a},a630:function(t,e,a){},ab99:function(t,e,a){},af50:function(t,e,a){},ba0b:function(t,e,a){"use strict";var i=a("a630"),n=a.n(i);n.a},ba23:function(t,e,a){"use strict";var i=a("748c"),n=a.n(i);n.a},bd3f:function(t,e,a){},c9be:function(t,e,a){"use strict";var i=a("5b49"),n=a.n(i);n.a},cd21:function(t,e,a){},cf97:function(t,e,a){},cfca:function(t,e,a){},d2ec:function(t,e,a){},d7e8:function(t,e,a){},dc2a:function(t,e,a){"use strict";var i=a("2d34"),n=a.n(i);n.a},dfa3:function(t,e,a){"use strict";var i=a("9a0c"),n=a.n(i);n.a},dfca:function(t,e,a){"use strict";var i=a("2571"),n=a.n(i);n.a},e03b:function(t,e,a){"use strict";var i=a("4660"),n=a.n(i);n.a},e08e:function(t,e,a){},e200:function(t,e,a){},eb43:function(t,e,a){},ec8b:function(t,e,a){},f507:function(t,e,a){},f5b0:function(t,e,a){"use strict";var i=a("d2ec"),n=a.n(i);n.a},f7b0:function(t,e,a){"use strict";var i=a("2eb7"),n=a.n(i);n.a},f7f3:function(t,e,a){"use strict";var i=a("e08e"),n=a.n(i);n.a},fcd1:function(t,e,a){},fd70:function(t,e,a){}});
//# sourceMappingURL=app.01a503c4.js.map